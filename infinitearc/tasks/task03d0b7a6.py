# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: 03d0b7a6
Difficulty: hard

=== Tags ===
- Pattern juxtaposition
- Recolor
- Shape guessing
- Pairwise analogy

=== Description ===
The task involves input grids containing multiple distinct visual shapes
arranged adjacent to each other (pattern juxtaposition). Each shape must be
identified through shape guessing (e.g., recognizing a triangle, circle, or
irregular polygon from its pixel configuration), requiring the solver to infer
the intended form from ambiguous or partial pixel arrangements. The output grid
is generated by recoloring each shape such that the color of one shape is
replaced by the color of another shape, based on a consistent pairwise analogy.
Specifically, for each input, the color of the shape identified as "Type A"
(e.g., a triangle) is replaced by the color of the shape identified as "Type B"
(e.g., a square), and vice versa. The exact mapping between shape types and
color swaps is consistent across all examples but necessitates precise shape
identification (shape guessing) before applying the pairwise analogy. The rule
is purely visual, relying on the spatial arrangement and structural properties
of the shapes rather than numerical values or pixel counts. Input grids feature
complex, non-trivial configurations with overlapping or partially obscured
shapes, demanding careful analysis to deduce the correct shape types and apply
the color transformation.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common

def generate():
    size = 30
    grid = common.grid(size, size, 0)
    shapes = ['el', 'aitch', 'you']
    shape1, shape2 = common.sample(shapes, 2)
    pixels1 = common.rand_sprite(shape1, size, size)
    pixels2 = common.rand_sprite(shape2, size, size)
    # Shift second shape to bottom-right to avoid overlap
    shift_r = size // 2
    shift_c = size // 2
    pixels2 = [(r + shift_r, c + shift_c) for r, c in pixels2]
    pixels2 = [(min(r, size-1), min(c, size-1)) for r, c in pixels2]
    color1 = common.random_color(exclude=[0])
    color2 = common.random_color(exclude=[0, color1])
    for r, c in pixels1:
        grid[r][c] = color1
    for r, c in pixels2:
        grid[r][c] = color2
    output = [row[:] for row in grid]
    for r in range(size):
        for c in range(size):
            if output[r][c] == color1:
                output[r][c] = color2
            elif output[r][c] == color2:
                output[r][c] = color1
    return {'input': grid, 'output': output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    colors = set()
    for row in input_grid:
        for cell in row:
            if cell != 0:
                colors.add(cell)
    colors = list(colors)
    if len(colors) == 2:
        color1, color2 = colors
    else:
        color1, color2 = colors[0], colors[0]
    output = []
    for row in input_grid:
        new_row = []
        for cell in row:
            if cell == color1:
                new_row.append(color2)
            elif cell == color2:
                new_row.append(color1)
            else:
                new_row.append(cell)
        output.append(new_row)
    return output
