# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 41923e5d
Difficulty: medium

=== Tags ===
- Detect grid

=== Description ===
The task involves transforming an input grid into an output grid by detecting
and marking the intersections of horizontal and vertical grid lines formed by a
single consistent color. The input grid contains horizontal lines (entire rows
filled with one color) and vertical lines (entire columns filled with the same
color). The output grid retains only the intersection points of these lines,
marking them with the line color, while all other cells are set to 0. The
transformation requires identifying the line color (which must appear in at
least one full row and one full column), determining all rows and columns that
are entirely this color, and then setting the corresponding intersections in the
output grid. This task tests the ability to detect structural patterns within a
grid through logical deduction rather than simple pixel manipulation.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(2, 30)
    height = random.randint(2, 30)
    C = random.randint(1, 9)
    num_horiz = random.randint(1, min(3, height - 1))
    horiz_rows = random.sample(range(height), num_horiz)
    num_vert = random.randint(1, min(3, width - 1))
    vert_cols = random.sample(range(width), num_vert)
    
    input_grid = [[0] * width for _ in range(height)]
    
    for r in horiz_rows:
        for c in range(width):
            input_grid[r][c] = C
    
    for c in vert_cols:
        for r in range(height):
            input_grid[r][c] = C
    
    for r in range(height):
        for c in range(width):
            if r not in horiz_rows and c not in vert_cols:
                color = random.randint(0, 9)
                while color == C:
                    color = random.randint(0, 9)
                input_grid[r][c] = color
    
    output_grid = [[0] * width for _ in range(height)]
    for r in horiz_rows:
        for c in vert_cols:
            output_grid[r][c] = C
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    C = None
    found_rows = []
    found_cols = []
    
    for color in range(1, 10):
        rows = []
        for r in range(height):
            if all(pixel == color for pixel in input_grid[r]):
                rows.append(r)
        cols = []
        for c in range(width):
            if all(input_grid[r][c] == color for r in range(height)):
                cols.append(c)
        if rows and cols:
            C = color
            found_rows = rows
            found_cols = cols
            break
    
    if C is None:
        C = 1
        found_rows = [0]
        found_cols = [0]
    
    output_grid = [[0] * width for _ in range(height)]
    for r in found_rows:
        for c in found_cols:
            output_grid[r][c] = C
    return output_grid
