# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 93e6cfb9
Difficulty: hard

=== Tags ===
- Pattern coloring
- Color permutation

=== Description ===
The task involves transforming an input grid into an output grid through a color
permutation rule determined by a specific diagonal pattern. Input grids are 2D
arrays of integers between 0 and 9, representing colors. The transformation
checks whether the main diagonal (positions (i, i) for all valid i) of the input
grid consists entirely of the color 5. If the diagonal is fully composed of 5s,
each color in the grid is incremented by 1 modulo 10 (e.g., 0→1, 9→0). If the
diagonal contains any color other than 5, each color is decremented by 1 modulo
10 (e.g., 0→9, 1→0). This rule requires recognizing the diagonal pattern as the
key determinant for the permutation direction, making it a hard task due to the
need for abstract pattern detection rather than direct pixel-level analysis.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

seen = set()

def generate():
    while True:
        s = random.randint(1, 30)
        grid = [[random.randint(0, 9) for _ in range(s)] for _ in range(s)]
        grid_tuple = tuple(tuple(row) for row in grid)
        if grid_tuple not in seen:
            seen.add(grid_tuple)
            diagonal = [grid[i][i] for i in range(s)]
            if all(x == 5 for x in diagonal):
                output_grid = [[(x + 1) % 10 for x in row] for row in grid]
            else:
                output_grid = [[(x - 1) % 10 for x in row] for row in grid]
            return {"input": grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    h = len(input_grid)
    w = len(input_grid[0])
    diag_len = min(h, w)
    diagonal = [input_grid[i][i] for i in range(diag_len)]
    if all(x == 5 for x in diagonal):
        return [[(x + 1) % 10 for x in row] for row in input_grid]
    else:
        return [[(x - 1) % 10 for x in row] for row in input_grid]
