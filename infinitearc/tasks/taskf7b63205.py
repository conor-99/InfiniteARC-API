# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: f7b63205
Difficulty: insane

=== Tags ===
- Phase transition path
- Gas expansion
- Pattern resizing

=== Description ===
The task involves transforming an input grid containing a seed pattern and a
phase indicator into an output grid where the seed expands outward in a sequence
of directions dictated by the phase indicator, with each layer of expansion
using a distinct color. The phase indicator (a single cell of a fixed color,
e.g., 9) determines the starting direction (e.g., top-left implies moving right
first), and subsequent directions cycle through right, up, left, down. Each
expansion layer is added in the current direction, filling adjacent background
cells with the next color in a sequence (e.g., 1, 2, 3), continuing until no
more background cells are available in the current direction. The expansion
stops when all possible directions have been exhausted or the grid boundaries
are reached, resulting in a larger, multi-colored pattern that visually expands
like a gas filling space while transitioning through phases. The output grid
maintains the original seed pattern, phase indicator, and background, with new
layers added only in background cells, creating a structured, phase-dependent
expansion path.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(10, 30)
    height = random.randint(10, 30)
    grid = [[0] * width for _ in range(height)]
    
    seed_r = random.randint(3, height - 4)
    seed_c = random.randint(3, width - 4)
    for r in [seed_r, seed_r + 1]:
        for c in [seed_c, seed_c + 1]:
            grid[r][c] = 1
    
    quadrant = random.choice(['top-left', 'top-right', 'bottom-right', 'bottom-left'])
    if quadrant == 'top-left':
        r = random.randint(0, height // 2 - 1)
        c = random.randint(0, width // 2 - 1)
    elif quadrant == 'top-right':
        r = random.randint(0, height // 2 - 1)
        c = random.randint(width // 2, width - 1)
    elif quadrant == 'bottom-right':
        r = random.randint(height // 2, height - 1)
        c = random.randint(width // 2, width - 1)
    else:
        r = random.randint(height // 2, height - 1)
        c = random.randint(0, width // 2 - 1)
    
    while (seed_r <= r <= seed_r + 1 and seed_c <= c <= seed_c + 1):
        r = random.randint(0, height - 1)
        c = random.randint(0, width - 1)
    grid[r][c] = 9
    
    output = [row[:] for row in grid]
    phase_r, phase_c = r, c
    if phase_r < height / 2 and phase_c < width / 2:
        start_dir = 0
    elif phase_r < height / 2 and phase_c >= width / 2:
        start_dir = 1
    elif phase_r >= height / 2 and phase_c >= width / 2:
        start_dir = 2
    else:
        start_dir = 3
    
    current_color = 2
    changed = True
    for _ in range(100):
        if not changed:
            break
        changed = False
        for dir in range(start_dir, start_dir + 4):
            dir = dir % 4
            to_expand = []
            for r in range(height):
                for c in range(width):
                    if output[r][c] != 0:
                        if dir == 0 and c + 1 < width and output[r][c + 1] == 0:
                            to_expand.append((r, c + 1))
                        elif dir == 1 and r + 1 < height and output[r + 1][c] == 0:
                            to_expand.append((r + 1, c))
                        elif dir == 2 and c - 1 >= 0 and output[r][c - 1] == 0:
                            to_expand.append((r, c - 1))
                        elif dir == 3 and r - 1 >= 0 and output[r - 1][c] == 0:
                            to_expand.append((r - 1, c))
            to_expand = list(set(to_expand))
            if to_expand:
                changed = True
                for r, c in to_expand:
                    output[r][c] = current_color
                if current_color < 9:
                    current_color += 1
    return {
        'input': grid,
        'output': output
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if isinstance(input_grid, tuple):
        input_grid = [list(row) for row in input_grid]
    height = len(input_grid)
    width = len(input_grid[0])
    phase_r, phase_c = -1, -1
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] == 9:
                phase_r, phase_c = r, c
                break
        if phase_r != -1:
            break
    
    if phase_r < height / 2 and phase_c < width / 2:
        start_dir = 0
    elif phase_r < height / 2 and phase_c >= width / 2:
        start_dir = 1
    elif phase_r >= height / 2 and phase_c >= width / 2:
        start_dir = 2
    else:
        start_dir = 3
    
    output = [row[:] for row in input_grid]
    current_color = 2
    changed = True
    for _ in range(100):
        if not changed:
            break
        changed = False
        for dir in range(start_dir, start_dir + 4):
            dir = dir % 4
            to_expand = []
            for r in range(height):
                for c in range(width):
                    if output[r][c] != 0:
                        if dir == 0 and c + 1 < width and output[r][c + 1] == 0:
                            to_expand.append((r, c + 1))
                        elif dir == 1 and r + 1 < height and output[r + 1][c] == 0:
                            to_expand.append((r + 1, c))
                        elif dir == 2 and c - 1 >= 0 and output[r][c - 1] == 0:
                            to_expand.append((r, c - 1))
                        elif dir == 3 and r - 1 >= 0 and output[r - 1][c] == 0:
                            to_expand.append((r - 1, c))
            to_expand = list(set(to_expand))
            if to_expand:
                changed = True
                for r, c in to_expand:
                    output[r][c] = current_color
                if current_color < 9:
                    current_color += 1
    return output
