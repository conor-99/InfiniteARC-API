# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-09
# ---------------------------------------------------------------

"""
Task ID: 4baf0d6a
Difficulty: hard

=== Tags ===
- Image reflection
- Paint by distance to line

=== Description ===
The task involves transforming an input grid into an output grid through two key
operations: reflection and distance-based color modification. The input grid is
a 2D array of integers (0-9) representing colors. The transformation begins by
reflecting the input grid vertically over its midline (the column at index
`floor((width-1)/2)`). This reflection swaps columns such that the left and
right halves mirror each other.   After reflection, each cell in the output grid
is modified based on its horizontal distance to the vertical midline. The
distance `d` for a cell at column `c` is calculated as `|c - mid|`. The output
color at position `(r, c)` is derived by taking the color of the corresponding
cell in the reflected input (which comes from the original input at `(r,
width-1-c)`) and adding the distance `d`, then taking the result modulo 10. This
ensures the output color remains within the 0-9 range while encoding positional
distance information.   For example, a cell originally at column `c` in the
input, after reflection to column `width-1-c`, has a distance `d = |(width-1-c)
- mid|` to the midline. The output color combines the original input color at
`(r, c)` (now reflected) with `d`, producing a new color that depends on both
the input's content and its positional relationship to the reflection line. This
dual-operation rule makes the task challenging, as it requires understanding
spatial reflection and integrating distance-based arithmetic into color mapping.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(2, 30)
    height = random.randint(1, 30)
    input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    mid = (width - 1) // 2
    reflected = [row[::-1] for row in input_grid]
    output_grid = []
    for r in range(height):
        new_row = []
        for c in range(width):
            d = abs(c - mid)
            new_val = (reflected[r][c] + d) % 10
            new_row.append(new_val)
        output_grid.append(new_row)
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input):
    width = len(input[0])
    height = len(input)
    mid = (width - 1) // 2
    reflected = [row[::-1] for row in input]
    output = []
    for r in range(height):
        output_row = []
        for c in range(width):
            d = abs(c - mid)
            new_val = (reflected[r][c] + d) % 10
            output_row.append(new_val)
        output.append(output_row)
    return output
