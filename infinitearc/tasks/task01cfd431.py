# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 01cfd431
Difficulty: medium

=== Tags ===
- Background filling
- Bridge gaps

=== Description ===
The input grids are 2D arrays of integers between 0 and 9, where 0 represents
empty space and non-zero values represent structural elements. The
transformation rule identifies "background gaps"â€”empty cells (0) positioned
directly between non-zero values in the same row (left and right neighbors) or
same column (top and bottom neighbors). Each such gap is filled with a
consistent bridge color (e.g., 5), while all other cells remain unchanged. This
process bridges disconnected segments of the structure by filling minimal gaps
between adjacent non-zero elements, effectively connecting separated parts of
the structure through the bridge color. The bridge color is distinct from
structural elements and remains constant across all transformations. Background
filling refers to the act of filling these specific gaps within the structural
background, not enclosing background areas.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random
def generate():
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    allowed_colors = [1, 2, 3, 4, 6, 7, 8, 9]
    input_grid = common.grid(width, height, 0)
    
    for r in range(height):
        for c in range(width):
            if random.random() > 0.7:
                input_grid[r][c] = random.choice(allowed_colors)
    
    found_gap = False
    for r in range(height):
        non_zero = [c for c in range(width) if input_grid[r][c] != 0]
        for i in range(len(non_zero) - 1):
            if non_zero[i+1] - non_zero[i] > 1:
                for c in range(non_zero[i] + 1, non_zero[i+1]):
                    input_grid[r][c] = 0
                found_gap = True
    if not found_gap:
        for c in range(width):
            non_zero = [r for r in range(height) if input_grid[r][c] != 0]
            for i in range(len(non_zero) - 1):
                if non_zero[i+1] - non_zero[i] > 1:
                    for r in range(non_zero[i] + 1, non_zero[i+1]):
                        input_grid[r][c] = 0
                    found_gap = True
    if not found_gap:
        r = random.randint(0, height - 1)
        c1 = random.randint(0, width - 3)
        c2 = c1 + 2
        input_grid[r][c1] = random.choice(allowed_colors)
        input_grid[r][c2] = random.choice(allowed_colors)
        input_grid[r][c1 + 1] = 0
    
    output_grid = [row[:] for row in input_grid]
    for r in range(height):
        non_zero = [c for c in range(width) if input_grid[r][c] != 0]
        for i in range(len(non_zero) - 1):
            for c in range(non_zero[i] + 1, non_zero[i+1]):
                if input_grid[r][c] == 0:
                    output_grid[r][c] = 5
    
    for c in range(width):
        non_zero = [r for r in range(height) if input_grid[r][c] != 0]
        for i in range(len(non_zero) - 1):
            for r in range(non_zero[i] + 1, non_zero[i+1]):
                if input_grid[r][c] == 0:
                    output_grid[r][c] = 5
    
    if input_grid == output_grid:
        return generate()
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    input_grid = [list(row) for row in input_grid]
    width = len(input_grid[0])
    height = len(input_grid)
    output_grid = [row[:] for row in input_grid]
    
    for r in range(height):
        non_zero = [c for c in range(width) if input_grid[r][c] != 0]
        for i in range(len(non_zero) - 1):
            for c in range(non_zero[i] + 1, non_zero[i+1]):
                if input_grid[r][c] == 0:
                    output_grid[r][c] = 5
    
    for c in range(width):
        non_zero = [r for r in range(height) if input_grid[r][c] != 0]
        for i in range(len(non_zero) - 1):
            for r in range(non_zero[i] + 1, non_zero[i+1]):
                if input_grid[r][c] == 0:
                    output_grid[r][c] = 5
    
    return output_grid
