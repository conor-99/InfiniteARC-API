# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-07
# ---------------------------------------------------------------

"""
Task ID: 16253e1d
Difficulty: medium

=== Tags ===
- Color guessing
- Algebra
- Draw line from border

=== Description ===
The task involves transforming an input grid into an output grid by drawing a
vertical line starting from the top border (row 0) at a column position
determined by the sum of all non-zero values in the input grid modulo the grid's
width. The line spans the entire height of the grid (from top to bottom) and
uses a color calculated as (sum of non-zero values modulo 9) + 1, ensuring it
falls within the valid color range of 1â€“9. The line replaces all existing values
in the designated column with this computed color, resulting in an output grid
that differs from the input. The transformation requires recognizing the
algebraic relationship between the grid's values and the line's position/color,
with the line always originating from the top border as specified.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    while True:
        width = random.randint(1, 30)
        height = random.randint(1, 30)
        input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
        sum_non_zero = sum(val for row in input_grid for val in row if val != 0)
        col = sum_non_zero % width
        color = (sum_non_zero % 9) + 1
        all_same = True
        for r in range(height):
            if input_grid[r][col] != color:
                all_same = False
                break
        if not all_same:
            break
    output_grid = [row[:] for row in input_grid]
    for r in range(height):
        output_grid[r][col] = color
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if isinstance(input_grid, tuple):
        input_grid = [list(row) for row in input_grid]
    if not input_grid or not input_grid[0]:
        return input_grid
    height = len(input_grid)
    width = len(input_grid[0])
    sum_non_zero = sum(val for row in input_grid for val in row if val != 0)
    col = sum_non_zero % width
    color = (sum_non_zero % 9) + 1
    output = [row[:] for row in input_grid]
    for r in range(height):
        output[r][col] = color
    return output
