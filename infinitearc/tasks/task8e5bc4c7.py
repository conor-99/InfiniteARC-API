# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-10
# ---------------------------------------------------------------

"""
Task ID: 8e5bc4c7
Difficulty: hard

=== Tags ===
- Image filling

=== Description ===
The task involves transforming an input grid by identifying all enclosed regions
of zeros (0) that are completely surrounded by non-zero values (i.e., regions of
zeros with no adjacent cells touching the grid boundary) and replacing each such
enclosed region with the color 7. Non-zero values remain unchanged, and zeros
that are not enclosed (touching the grid boundary) retain their value of 0. The
transformation requires recognizing topological enclosure through connectivity
analysis, where enclosed regions must be fully bounded by non-zero cells without
connection to the grid edges. This rule is consistent across all valid inputs
and outputs, with the output grid containing exactly the same non-zero values as
the input, except for the filled enclosed zero regions.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    grid = [[1] * width for _ in range(height)]
    for r in range(1, height - 1):
        for c in range(1, width - 1):
            if random.random() < 0.3:
                grid[r][c] = 0
    if all(grid[r][c] != 0 for r in range(1, height - 1) for c in range(1, width - 1)):
        r, c = random.randint(1, height - 2), random.randint(1, width - 2)
        grid[r][c] = 0
    output = [[7 if cell == 0 else cell for cell in row] for row in grid]
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if not input_grid:
        return []
    height = len(input_grid)
    width = len(input_grid[0])
    visited = [[False] * width for _ in range(height)]
    from collections import deque
    queue = deque()
    for r in [0, height - 1]:
        for c in range(width):
            if input_grid[r][c] == 0 and not visited[r][c]:
                visited[r][c] = True
                queue.append((r, c))
    for c in [0, width - 1]:
        for r in range(1, height - 1):
            if input_grid[r][c] == 0 and not visited[r][c]:
                visited[r][c] = True
                queue.append((r, c))
    while queue:
        r, c = queue.popleft()
        for dr, dc in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            nr, nc = r + dr, c + dc
            if 0 <= nr < height and 0 <= nc < width and not visited[nr][nc] and input_grid[nr][nc] == 0:
                visited[nr][nc] = True
                queue.append((nr, nc))
    output = []
    for r in range(height):
        row = []
        for c in range(width):
            if input_grid[r][c] == 0 and not visited[r][c]:
                row.append(7)
            else:
                row.append(input_grid[r][c])
        output.append(row)
    return output
