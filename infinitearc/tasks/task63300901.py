# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-11
# ---------------------------------------------------------------

"""
Task ID: 63300901
Difficulty: medium–hard

=== Tags ===
- Obstacles
- Hollow core detection
- Associate colors to colors

=== Description ===
Each input grid features a single enclosed hollow core—a contiguous background
region (color 0) completely surrounded by a single obstacle color (1–9). The
hollow core is not connected to the grid's edges. In the output grid, the hollow
core is filled with a color associated with the surrounding obstacle color via a
fixed mapping: obstacle color 1 maps to 5, 2 to 3, 3 to 8, 4 to 2, 5 to 7, 6 to
9, 7 to 4, 8 to 1, and 9 to 6. All other grid elements remain unchanged.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def obstacle_to_color(c):
    mapping = {
        1: 5,
        2: 3,
        3: 8,
        4: 2,
        5: 7,
        6: 9,
        7: 4,
        8: 1,
        9: 6
    }
    return mapping[c]

def generate():
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    c_obstacle = random.randint(1, 9)
    
    r = random.randint(1, height - 2)
    c = random.randint(1, width - 2)
    h = random.randint(1, height - r - 1)
    w = random.randint(1, width - c - 1)
    
    input_grid = [[0] * width for _ in range(height)]
    
    for col in range(c, c + w):
        input_grid[r - 1][col] = c_obstacle
        input_grid[r + h][col] = c_obstacle
    for row in range(r, r + h):
        input_grid[row][c - 1] = c_obstacle
        input_grid[row][c + w] = c_obstacle
    
    output_grid = [row[:] for row in input_grid]
    for i in range(r, r + h):
        for j in range(c, c + w):
            output_grid[i][j] = obstacle_to_color(c_obstacle)
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def obstacle_to_color(c):
    mapping = {
        1: 5,
        2: 3,
        3: 8,
        4: 2,
        5: 7,
        6: 9,
        7: 4,
        8: 1,
        9: 6
    }
    return mapping[c]

def p(input_grid):
    if isinstance(input_grid[0], tuple):
        input_grid = [list(row) for row in input_grid]
    
    width = len(input_grid[0])
    height = len(input_grid)
    
    visited = [[False] * width for _ in range(height)]
    enclosed_regions = []
    
    for i in range(height):
        for j in range(width):
            if input_grid[i][j] == 0 and not visited[i][j]:
                stack = [(i, j)]
                visited[i][j] = True
                region = []
                is_enclosed = True
                while stack:
                    x, y = stack.pop()
                    if x == 0 or x == height - 1 or y == 0 or y == width - 1:
                        is_enclosed = False
                    region.append((x, y))
                    for dx, dy in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
                        nx, ny = x + dx, y + dy
                        if 0 <= nx < height and 0 <= ny < width and not visited[nx][ny] and input_grid[nx][ny] == 0:
                            visited[nx][ny] = True
                            stack.append((nx, ny))
                if is_enclosed:
                    enclosed_regions.append(region)
    
    if not enclosed_regions:
        return input_grid
    region = enclosed_regions[0]
    
    obstacle_color = None
    for (x, y) in region:
        for dx, dy in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            nx, ny = x + dx, y + dy
            if 0 <= nx < height and 0 <= ny < width:
                color = input_grid[nx][ny]
                if color != 0:
                    if obstacle_color is None:
                        obstacle_color = color
                    elif obstacle_color != color:
                        pass
    if obstacle_color is None:
        obstacle_color = 1
    
    new_color = obstacle_to_color(obstacle_color)
    
    output_grid = [row[:] for row in input_grid]
    for (x, y) in region:
        output_grid[x][y] = new_color
    
    return output_grid
