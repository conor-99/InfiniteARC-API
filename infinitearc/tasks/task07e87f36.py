# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 07e87f36
Difficulty: hard

=== Tags ===
- Separate image
- Neighbor color sum modulo n

=== Description ===
The input grids are two-dimensional arrays of colors (0-9) with dimensions
ranging from 1×1 to 30×30. The output grid is derived by computing, for each
cell, the sum of the colors of its four orthogonally adjacent neighbors (up,
down, left, right), then applying modulo 5 to this sum. The resulting value
(0–4) becomes the color of the corresponding cell in the output grid. This
transformation creates a new visual pattern where the output grid reveals the
underlying neighbor-based color aggregation, requiring the solver to identify
the modulo operation and neighbor summation to reconstruct the output from the
input.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    while True:
        width = random.randint(1, 30)
        height = random.randint(1, 30)
        input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
        output_grid = [[0] * width for _ in range(height)]
        for i in range(height):
            for j in range(width):
                total = 0
                if i > 0:
                    total += input_grid[i-1][j]
                if i < height - 1:
                    total += input_grid[i+1][j]
                if j > 0:
                    total += input_grid[i][j-1]
                if j < width - 1:
                    total += input_grid[i][j+1]
                output_grid[i][j] = total % 5
        if input_grid != output_grid:
            return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input):
    height = len(input)
    width = len(input[0])
    output = [[0] * width for _ in range(height)]
    for i in range(height):
        for j in range(width):
            total = 0
            if i > 0:
                total += input[i-1][j]
            if i < height - 1:
                total += input[i+1][j]
            if j > 0:
                total += input[i][j-1]
            if j < width - 1:
                total += input[i][j+1]
            output[i][j] = total % 5
    return output
