# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: c6664d6c
Difficulty: medium

=== Tags ===
- Detect grid
- Outline shapes
- Inside out
- Pattern modification

=== Description ===
The input grid consists of a 2D array of integers between 0 and 9, where non-
zero values represent filled shapes on a background of 0. The task requires
transforming each filled shape into its outline by preserving only the perimeter
cells of the shape (cells adjacent to at least one background cell) in their
original color, while setting all interior cells (surrounded by the same shape)
to 0. This "inside out" transformation effectively reverses the interior and
exterior of each shape, resulting in the output grid displaying the boundaries
of the original shapes. The transformation must be applied consistently across
all connected regions of non-zero values, ensuring that no input grid remains
identical to its output.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common

def generate():
    width = common.randint(3, 30)
    height = common.randint(3, 30)
    color = common.random_color(exclude=[0])
    rect_w = common.randint(3, min(10, width))
    rect_h = common.randint(3, min(10, height))
    start_x = common.randint(0, width - rect_w)
    start_y = common.randint(0, height - rect_h)
    
    input_grid = common.grid(width, height, 0)
    for r in range(start_y, start_y + rect_h):
        for c in range(start_x, start_x + rect_w):
            input_grid[r][c] = color
    
    output_grid = common.grid(width, height, 0)
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                has_background = False
                for dr, dc in [(0,1), (0,-1), (1,0), (-1,0)]:
                    nr, nc = r + dr, c + dc
                    if nr < 0 or nr >= height or nc < 0 or nc >= width:
                        has_background = True
                        break
                    if input_grid[nr][nc] == 0:
                        has_background = True
                        break
                if has_background:
                    output_grid[r][c] = input_grid[r][c]
    
    if input_grid == output_grid:
        return generate()
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    output_grid = common.grid(width, height, 0)
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                has_background = False
                for dr, dc in [(0,1), (0,-1), (1,0), (-1,0)]:
                    nr, nc = r + dr, c + dc
                    if nr < 0 or nr >= height or nc < 0 or nc >= width:
                        has_background = True
                        break
                    if input_grid[nr][nc] == 0:
                        has_background = True
                        break
                if has_background:
                    output_grid[r][c] = input_grid[r][c]
    return output_grid
