# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: 4fc55c69
Difficulty: medium

=== Tags ===
- Associate colors to ranks

=== Description ===
The input grids are 2D arrays of integers ranging from 0 to 9, representing
colored pixels. Each grid contains a subset of these colors, with no requirement
for all 10 colors to be present. The transformation rule involves identifying
all unique colors present in the input grid, sorting them in descending
numerical order, and assigning each color a rank starting from 0 (e.g., the
highest color value gets rank 0, the next highest rank 1, etc.). The output grid
is generated by replacing each pixel's original color with its corresponding
rank based on this dynamic ordering. This process ensures that the output grid
is structurally different from the input, as the rank assignment depends on the
specific color distribution within each grid. For example, an input containing
colors [1, 3, 5] would have ranks 0→5, 1→3, 2→1, resulting in an output where 5
becomes 0, 3 becomes 1, and 1 becomes 2. The task requires recognizing that the
rank mapping is determined by the input's own color composition, not by a fixed
global ordering.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from common import grid, randint

def generate():
    while True:
        width = randint(1, 30)
        height = randint(1, 30)
        input_grid = grid(width, height, 0)
        for r in range(height):
            for c in range(width):
                input_grid[r][c] = randint(0, 9)
        if all(input_grid[r][c] == 0 for r in range(height) for c in range(width)):
            r, c = random.randint(0, height-1), random.randint(0, width-1)
            input_grid[r][c] = randint(1, 9)
        colors = set()
        for r in range(height):
            for c in range(width):
                colors.add(input_grid[r][c])
        sorted_colors = sorted(colors, reverse=True)
        color_to_rank = {color: idx for idx, color in enumerate(sorted_colors)}
        output_grid = []
        for r in range(height):
            row = []
            for c in range(width):
                row.append(color_to_rank[input_grid[r][c]])
            output_grid.append(row)
        if input_grid == output_grid:
            continue
        return {'input': input_grid, 'output': output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    colors = set()
    for row in input_grid:
        for color in row:
            colors.add(color)
    sorted_colors = sorted(colors, reverse=True)
    color_to_rank = {color: idx for idx, color in enumerate(sorted_colors)}
    output_grid = []
    for row in input_grid:
        output_row = [color_to_rank[color] for color in row]
        output_grid.append(output_row)
    return output_grid
