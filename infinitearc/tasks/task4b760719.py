# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 4b760719
Difficulty: hard

=== Tags ===
- Detect background color
- Infer hidden grid

=== Description ===
The input grids are 2D grids where a specific background color dominates the
border (first and last rows, first and last columns), but is not necessarily the
most frequent color in the entire grid. The background color is determined by
identifying the single most frequent color in all border cells. The output grid
is formed by replacing every instance of this background color with 0, thereby
revealing the underlying hidden grid structure composed of non-background
colors. This task requires the model to isolate border cells for background
detection (rather than analyzing the entire grid), then apply a consistent
global transformation to reveal the hidden pattern. The challenge lies in
focusing on border-specific color distribution and avoiding distraction from the
interior grid's color frequencies.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    b_color = random.randint(1, 9)
    grid = [[0] * width for _ in range(height)]
    
    border_positions = []
    for c in range(width):
        border_positions.append((0, c))
        border_positions.append((height - 1, c))
    for r in range(1, height - 1):
        border_positions.append((r, 0))
        border_positions.append((r, width - 1))
    
    random.shuffle(border_positions)
    num_b_color = max(2, int(0.7 * len(border_positions)))
    
    for i in range(num_b_color):
        r, c = border_positions[i]
        grid[r][c] = b_color
    
    other_colors = [c for c in range(1, 10) if c != b_color]
    for i in range(num_b_color, len(border_positions)):
        r, c = border_positions[i]
        grid[r][c] = random.choice(other_colors)
    
    for r in range(1, height - 1):
        for c in range(1, width - 1):
            grid[r][c] = random.randint(0, 9)
    
    output = [[0 if cell == b_color else cell for cell in row] for row in grid]
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    
    border_cells = []
    for c in range(width):
        border_cells.append(input_grid[0][c])
        border_cells.append(input_grid[height - 1][c])
    for r in range(1, height - 1):
        border_cells.append(input_grid[r][0])
        border_cells.append(input_grid[r][width - 1])
    
    if not border_cells:
        b_color = input_grid[0][0]
    else:
        freq = {}
        for cell in border_cells:
            freq[cell] = freq.get(cell, 0) + 1
        b_color = max(freq, key=freq.get)
    
    output = []
    for row in input_grid:
        new_row = []
        for cell in row:
            new_row.append(0 if cell == b_color else cell)
        output.append(new_row)
    return output
