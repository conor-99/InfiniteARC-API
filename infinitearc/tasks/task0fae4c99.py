# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 0fae4c99
Difficulty: hard

=== Tags ===
- Agent memory trace
- Column parity coloring

=== Description ===
Input grids consist of 2D color grids (values 0-9, where 0 is background) with
columns containing varying patterns of non-background colors (1-9). The grids
exhibit a structural pattern where columns alternate between containing content
and being empty, with non-background columns appearing at even indices (0, 2, 4,
...) and odd-indexed columns initially containing background or partial
patterns. The output grid is generated through a two-phase transformation:
first, all even-indexed columns are preserved unchanged; second, each odd-
indexed column is replaced by the color pattern from the nearest even-indexed
column to its left that contains at least one non-background color. If no such
column exists to the left (e.g., for the first column), the odd column becomes
entirely background. This "memory trace" requires the agent to sequentially
track the last non-background even column while processing columns left-to-
right, creating a dependency chain that must be resolved to correctly map the
input to output. The transformation is visual and does not rely on numerical
operations, instead requiring the agent to recognize and propagate color
patterns through positional parity and contextual memory.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    w = random.randint(2, 30)
    h = random.randint(1, 30)
    input_grid = [[0] * w for _ in range(h)]
    
    for i in range(0, w, 2):
        r = random.randint(0, h-1)
        input_grid[r][i] = random.randint(1, 9)
        for r2 in range(h):
            if r2 != r:
                input_grid[r2][i] = random.randint(0, 9)
    
    for i in range(1, w, 2):
        for r in range(h):
            input_grid[r][i] = random.randint(0, 9)
    
    output_grid = [[0] * w for _ in range(h)]
    for i in range(w):
        if i % 2 == 0:
            for r in range(h):
                output_grid[r][i] = input_grid[r][i]
        else:
            for r in range(h):
                output_grid[r][i] = input_grid[r][i-1]
    
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    h = len(input_grid)
    w = len(input_grid[0])
    output = [[0] * w for _ in range(h)]
    for i in range(w):
        for r in range(h):
            if i % 2 == 0:
                output[r][i] = input_grid[r][i]
            else:
                output[r][i] = input_grid[r][i-1]
    return output
