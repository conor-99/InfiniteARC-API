# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: 7f39dd92
Difficulty: hard

=== Tags ===
- Detect background color

=== Description ===
The input grid is a 2D grid of integers between 0 and 9, representing colors.
The background color is defined as the most frequently occurring color in the
perimeter pixels (all pixels in the first row, last row, first column, and last
column of the grid). In cases where multiple colors tie for the highest
frequency, the smallest color value is selected. The output grid is generated by
replacing every instance of the detected background color with color 0 (black),
while all other colors remain unchanged. This transformation requires
identifying the background color through perimeter analysis and applying a
uniform replacement across the entire grid.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    bg_color = random.randint(1, 9)
    input_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            if r == 0 or r == height - 1 or c == 0 or c == width - 1:
                input_grid[r][c] = bg_color
    for r in range(1, height - 1):
        for c in range(1, width - 1):
            input_grid[r][c] = random.randint(0, 9)
    output_grid = [[0 if cell == bg_color else cell for cell in row] for row in input_grid]
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if not input_grid:
        return []
    height = len(input_grid)
    width = len(input_grid[0])
    perimeter = []
    for r in range(height):
        for c in range(width):
            if r == 0 or r == height - 1 or c == 0 or c == width - 1:
                perimeter.append(input_grid[r][c])
    freq = {}
    for color in perimeter:
        freq[color] = freq.get(color, 0) + 1
    max_freq = max(freq.values())
    modes = [color for color, count in freq.items() if count == max_freq]
    bg_color = min(modes)
    output_grid = []
    for r in range(height):
        new_row = []
        for c in range(width):
            if input_grid[r][c] == bg_color:
                new_row.append(0)
            else:
                new_row.append(input_grid[r][c])
        output_grid.append(new_row)
    return output_grid
