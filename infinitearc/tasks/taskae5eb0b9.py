# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: ae5eb0b9
Difficulty: medium

=== Tags ===
- Bridges
- Sort colors by index
- Periodic tiling

=== Description ===
The input grid features a single horizontal or vertical bridge that spans the
entire grid's width or height, composed of connected non-background cells (color
values between 1-9). The bridge's color sequence must be sorted in ascending
numerical order (e.g., 1, 2, 3, ..., 9). The output grid is constructed by
tiling this sorted sequence periodically: for a horizontal bridge, the sorted
sequence repeats across every row; for a vertical bridge, the sequence repeats
down every column. The tiling pattern fills the output grid without altering its
dimensions, creating a consistent visual repetition of the sorted colors. This
task requires recognizing bridge orientation, sorting color values, and applying
periodic repetition to generate the output.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common

def generate():
    width = common.randint(2, 30)
    height = common.randint(2, 30)
    is_horizontal = common.choice([True, False])
    input_grid = common.grid(width, height, 0)
    output_grid = common.grid(width, height, 0)
    if is_horizontal:
        row_idx = common.randint(0, height - 1)
        bridge_colors = [common.randint(1, 9) for _ in range(width)]
        while bridge_colors == sorted(bridge_colors):
            bridge_colors = [common.randint(1, 9) for _ in range(width)]
        input_grid[row_idx] = bridge_colors
        sorted_colors = sorted(bridge_colors)
        for r in range(height):
            output_grid[r] = sorted_colors.copy()
    else:
        col_idx = common.randint(0, width - 1)
        bridge_colors = [common.randint(1, 9) for _ in range(height)]
        while bridge_colors == sorted(bridge_colors):
            bridge_colors = [common.randint(1, 9) for _ in range(height)]
        for r in range(height):
            input_grid[r][col_idx] = bridge_colors[r]
        sorted_colors = sorted(bridge_colors)
        for c in range(width):
            for r in range(height):
                output_grid[r][c] = sorted_colors[r]
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    for r in range(height):
        if all(cell != 0 for cell in input_grid[r]):
            bridge_colors = input_grid[r]
            sorted_colors = sorted(bridge_colors)
            return [sorted_colors[:] for _ in range(height)]
    for c in range(width):
        all_nonzero = True
        for r in range(height):
            if input_grid[r][c] == 0:
                all_nonzero = False
                break
        if all_nonzero:
            bridge_colors = [input_grid[r][c] for r in range(height)]
            sorted_colors = sorted(bridge_colors)
            output_grid = []
            for r in range(height):
                output_grid.append([sorted_colors[r]] * width)
            return output_grid
    return input_grid
