# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: 403f3342
Difficulty: easy

=== Tags ===
- Find the odd shape out
- Count shapes
- Color palette

=== Description ===
The input grids contain multiple distinct shapes (connected regions of the same
color), where all shapes share a common color except for one shape that uses a
different color. The output grid is identical to the input grid, except the
color of the uniquely colored shape is changed to a fixed marker color (e.g.,
yellow). This task requires identifying the shape that stands out due to its
color difference and applying a consistent color replacement rule to it.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random
def generate():
    w = random.randint(5, 15)
    h = random.randint(5, 15)
    colors = list(range(1, 10))
    X = random.choice(colors)
    colors.remove(X)
    if 4 in colors:
        colors.remove(4)
    Y = random.choice(colors)
    
    input_grid = common.grid(w, h, 0)
    
    x1_pixels = common.rand_sprite("el", 3, 3)
    for r, c in x1_pixels:
        if 0 <= r < h and 0 <= c < w:
            input_grid[r][c] = X
    
    x2_pixels = common.rand_sprite("you", 3, 3)
    dx, dy = w - 3, h - 3
    for r, c in x2_pixels:
        if 0 <= r + dy < h and 0 <= c + dx < w:
            input_grid[r + dy][c + dx] = X
    
    y_pixels = common.rand_sprite("aitch", 3, 3)
    dx, dy = w // 2 - 1, h // 2 - 1
    for r, c in y_pixels:
        if 0 <= r + dy < h and 0 <= c + dx < w:
            input_grid[r + dy][c + dx] = Y
    
    output_grid = [row[:] for row in input_grid]
    for r in range(h):
        for c in range(w):
            if output_grid[r][c] == Y:
                output_grid[r][c] = 4
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common
def p(input_grid):
    if isinstance(input_grid, tuple):
        input_grid = [list(row) for row in input_grid]
    elif input_grid and isinstance(input_grid[0], tuple):
        input_grid = [list(row) for row in input_grid]
    
    h = len(input_grid)
    w = len(input_grid[0])
    visited = [[False] * w for _ in range(h)]
    color_regions = {}
    directions = [(1,0), (-1,0), (0,1), (0,-1)]
    
    for r in range(h):
        for c in range(w):
            if not visited[r][c] and input_grid[r][c] != 0:
                color = input_grid[r][c]
                stack = [(r, c)]
                visited[r][c] = True
                while stack:
                    cr, cc = stack.pop()
                    for dr, dc in directions:
                        nr, nc = cr + dr, cc + dc
                        if 0 <= nr < h and 0 <= nc < w and not visited[nr][nc] and input_grid[nr][nc] == color:
                            visited[nr][nc] = True
                            stack.append((nr, nc))
                color_regions[color] = color_regions.get(color, 0) + 1
    
    odd_color = next(color for color, count in color_regions.items() if count == 1)
    output_grid = [row[:] for row in input_grid]
    for r in range(h):
        for c in range(w):
            if output_grid[r][c] == odd_color:
                output_grid[r][c] = 4
    return output_grid
