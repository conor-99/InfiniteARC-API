# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: c20c05eb
Difficulty: medium–hard

=== Tags ===
- Competitive agents
- Color particle emission
- Reflect across detected axis
- Even or odd

=== Description ===
Input grids feature a background of color 0 with multiple scattered colored
particles (each a single cell of color 1–9). The particles represent competitive
agents that emit their color in a visible pattern across the grid. To generate
the output, first count all non-background particles. If the total count is
even, reflect the entire grid across its vertical midline (left-right mirror).
If the count is odd, reflect across the horizontal midline (top-bottom mirror).
This reflection applies to all cells, including particles and background,
preserving all particle colors while mirroring their positions. The output grid
maintains identical dimensions to the input, with no overlap or modification of
particle colors during reflection. The reflection axis is dynamically detected
from the input's particle count parity, creating a visually consistent
transformation that requires recognizing both the global particle count and
applying the correct symmetry operation.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from common import grid
def generate():
    while True:
        width = random.randint(1, 30)
        height = random.randint(1, 30)
        grid_input = grid(width, height, 0)
        num_particles = random.randint(1, width * height)
        for _ in range(num_particles):
            r = random.randint(0, height - 1)
            c = random.randint(0, width - 1)
            grid_input[r][c] = random.randint(1, 9)
        count = sum(1 for row in grid_input for cell in row if cell != 0)
        if count % 2 == 0:
            grid_output = [row[::-1] for row in grid_input]
        else:
            grid_output = grid_input[::-1]
        if grid_input != grid_output:
            return {"input": grid_input, "output": grid_output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    grid_input = [list(row) for row in input_grid]
    count = sum(1 for row in grid_input for cell in row if cell != 0)
    if count % 2 == 0:
        return [row[::-1] for row in grid_input]
    else:
        return grid_input[::-1]
