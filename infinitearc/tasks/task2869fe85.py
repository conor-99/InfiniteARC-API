# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 2869fe85
Difficulty: hard

=== Tags ===
- Palette compression
- Constraint satisfaction coloring
- Even or odd

=== Description ===
The task involves transforming an input grid into an output grid by modifying
colors based on the parity of their frequency. For each color present in the
input grid, if the total number of cells with that color is odd, all such cells
are replaced with 0 in the output. Colors that appear an even number of times
remain unchanged. This process compresses the palette by eliminating colors with
odd frequencies and ensures the output grid adheres to the constraint that only
colors with even input frequencies are preserved, with all others replaced by 0.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    
    counts = [0] * 10
    for row in input_grid:
        for color in row:
            counts[color] += 1
    
    all_even = True
    for color in range(1, 10):
        if counts[color] % 2 != 0:
            all_even = False
            break
    
    if all_even:
        found = False
        for r in range(height):
            for c in range(width):
                if input_grid[r][c] != 0:
                    input_grid[r][c] = 0
                    found = True
                    break
            if found:
                break
        if not found:
            r = random.randint(0, height-1)
            c = random.randint(0, width-1)
            input_grid[r][c] = random.randint(1, 9)
        
        counts = [0] * 10
        for row in input_grid:
            for color in row:
                counts[color] += 1
    
    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            color = input_grid[r][c]
            if color == 0:
                output_grid[r][c] = 0
            else:
                if counts[color] % 2 == 1:
                    output_grid[r][c] = 0
                else:
                    output_grid[r][c] = color
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import random

def p(input_grid):
    if not input_grid or not input_grid[0]:
        return []
    
    width = len(input_grid[0])
    height = len(input_grid)
    
    counts = [0] * 10
    for row in input_grid:
        for color in row:
            counts[color] += 1
    
    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            color = input_grid[r][c]
            if color == 0:
                output_grid[r][c] = 0
            else:
                if counts[color] % 2 == 1:
                    output_grid[r][c] = 0
                else:
                    output_grid[r][c] = color
    
    return output_grid
