# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: f657cf26
Difficulty: hard

=== Tags ===
- Associate colors to colors
- Recolor

=== Description ===
The task involves input grids containing a complex arrangement of colors (0-9)
where each cell's color is mapped to a new color according to a rule defined by
the first row of the input grid. Specifically, the first row of the input grid
contains a permutation of the colors 0 through 9, which serves as a lookup
table. For any cell with color `c` in the input grid, the corresponding cell in
the output grid is replaced with the color located at position `c` in the first
row of the input. For example, if the first row is [3, 7, 5, 1, 9, 2, 4, 8, 0,
6], then all input cells with color 0 become color 3, color 1 becomes 7, color 2
becomes 5, and so on. The input grids are designed to be visually complex, with
numerous distinct colors arranged in intricate patterns, making the mapping rule
non-obvious. The solver must identify the permutation in the first row and apply
it consistently across the entire grid to generate the correct output. This
requires recognizing the relationship between the first row and the color
transformation, which is challenging due to the need to correlate the sequence
in the first row with the color changes throughout the grid.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    height = random.randint(1, 30)
    width = 10
    perm = list(range(10))
    random.shuffle(perm)
    while perm == list(range(10)):
        random.shuffle(perm)
    
    input_grid = [[0]*width for _ in range(height)]
    input_grid[0] = perm
    
    for r in range(1, height):
        for c in range(width):
            input_grid[r][c] = random.randint(0, 9)
    
    output_grid = [[0]*width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            color = input_grid[r][c]
            output_grid[r][c] = perm[color]
    
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    perm = input_grid[0]
    output = [[0] * len(input_grid[0]) for _ in range(len(input_grid))]
    for r in range(len(input_grid)):
        for c in range(len(input_grid[0])):
            output[r][c] = perm[input_grid[r][c]]
    return output
