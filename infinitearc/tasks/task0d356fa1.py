# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: 0d356fa1
Difficulty: hard

=== Tags ===
- Axis inference
- Fractal repetition

=== Description ===
The task involves input grids containing a fractal pattern that repeats at a 2Ã—2
scale along a primary axis (horizontal or vertical). The axis must be inferred
by analyzing the continuity of the pattern: horizontal repetition is indicated
when the pattern aligns across columns (e.g., consistent structure in adjacent
column pairs), while vertical repetition aligns across rows. The output grid is
generated by transposing the input if horizontal repetition is inferred (to
align the fractal with the vertical axis), or leaving it unchanged if vertical
repetition is detected. This requires recognizing the fractal's directional
repetition through abstract pattern analysis rather than pixel-level matching.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    h = random.randint(1, 30)
    k = random.randint(2, 15)
    w = 2 * k
    if h == w:
        h = h + 1 if h < 30 else h - 1
    base = [[random.randint(0, 9) for _ in range(2)] for _ in range(h)]
    input_grid = []
    for i in range(h):
        row = []
        for j in range(w):
            row.append(base[i][j % 2])
        input_grid.append(row)
    output_grid = [list(x) for x in zip(*input_grid)]
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    h = len(input_grid)
    w = len(input_grid[0])
    horizontal = True
    for j in range(2, w):
        for i in range(h):
            if input_grid[i][j] != input_grid[i][j-2]:
                horizontal = False
                break
        if not horizontal:
            break
    if horizontal:
        return [list(x) for x in zip(*input_grid)]
    vertical = True
    for i in range(2, h):
        for j in range(w):
            if input_grid[i][j] != input_grid[i-2][j]:
                vertical = False
                break
        if not vertical:
            break
    if vertical:
        return input_grid
    return [list(x) for x in zip(*input_grid)]
