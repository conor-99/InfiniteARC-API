# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-10
# ---------------------------------------------------------------

"""
Task ID: 570bb823
Difficulty: very hard

=== Tags ===
- Contextual rule switch
- Select every nth column

=== Description ===
# Contextual Column Filter  Input grids are up to 30Ã—30 with a background color
(0) and multiple colored cells. The top-left cell (0,0) contains a marker color
(1-9). The grid contains a horizontal line of color 8 spanning all columns in
row 1 (every cell in row 1 must be exactly 8 for this condition to be true).
The output grid is formed by selecting every nth column from the input grid,
where n is determined by a contextual rule: - If row 1 contains a solid
horizontal line of color 8, then n equals the marker color value (from cell
(0,0)). - Otherwise, n equals 2.  Columns are selected starting from column 0
(i.e., columns 0, n, 2n, etc.). The output grid maintains the original order of
the selected columns and preserves all cell colors from the input. The
transformation requires both detecting the presence of a specific visual pattern
(color 8 line in row 1) and applying a conditional rule based on the marker
color, making it challenging to identify the correct transformation rule from
the input's visual features.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    height = random.randint(2, 30)
    width = random.randint(2, 30)
    grid = [[0] * width for _ in range(height)]
    
    marker_color = random.randint(1, 9)
    grid[0][0] = marker_color
    
    use_marker = random.choice([True, False])
    if use_marker:
        for c in range(width):
            grid[1][c] = 8
        if marker_color == 1:
            marker_color = random.randint(2, 9)
            grid[0][0] = marker_color
        n = marker_color
    else:
        for c in range(width):
            grid[1][c] = 0
        n = 2
    
    output_grid = []
    for r in range(height):
        new_row = []
        c_index = 0
        while c_index < width:
            new_row.append(grid[r][c_index])
            c_index += n
        output_grid.append(new_row)
    
    return {"input": grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import random

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    
    row1_all_8 = True
    for c in range(width):
        if input_grid[1][c] != 8:
            row1_all_8 = False
            break
    
    n = input_grid[0][0] if row1_all_8 else 2
    
    output_grid = []
    for r in range(height):
        new_row = []
        c_index = 0
        while c_index < width:
            new_row.append(input_grid[r][c_index])
            c_index += n
        output_grid.append(new_row)
    
    return output_grid
