# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-07
# ---------------------------------------------------------------

"""
Task ID: e5f84299
Difficulty: medium

=== Tags ===
- Associate patterns to patterns
- Expand repeating unit
- Associate colors to colors
- Contouring

=== Description ===
The task involves transforming an input grid into an output grid by expanding a
single contiguous shape (connected via edge-sharing pixels) and applying color
associations and contouring. The input grid features a non-zero color shape on a
zero background. The output is generated through the following steps: (1) Each
pixel of the shape is expanded into a 2×2 block, doubling the grid dimensions;
(2) The shape's original color is mapped to a new color via a fixed association
(e.g., color 1 → 3, color 2 → 5); (3) A single-layer contour (color 9) is added
around the perimeter of the expanded shape. The background (color 0) remains
unchanged, and all rules apply consistently regardless of shape size or
position. This process combines pattern expansion, color mapping, and contouring
to create a medium-difficulty reasoning challenge.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random

def generate():
    size = random.randint(1, 10)
    shape_pixels = common.continuous_creature(size, width=30, height=30)
    if not shape_pixels:
        shape_pixels = [(0, 0)]
    min_r = min(r for r, c in shape_pixels)
    max_r = max(r for r, c in shape_pixels)
    min_c = min(c for r, c in shape_pixels)
    max_c = max(c for r, c in shape_pixels)
    width = max_c - min_c + 1
    height = max_r - min_r + 1
    input_grid = common.grid(width, height, 0)
    color = random.randint(1, 9)
    for r, c in shape_pixels:
        input_grid[r - min_r][c - min_c] = color
    mapped_color = (color % 9) + 1
    expanded_height = height * 2
    expanded_width = width * 2
    output_grid = common.grid(expanded_width, expanded_height, 0)
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                for dr in range(2):
                    for dc in range(2):
                        output_grid[r*2 + dr][c*2 + dc] = mapped_color
    for r in range(expanded_height):
        for c in range(expanded_width):
            if output_grid[r][c] != 0:
                for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                    nr, nc = r + dr, c + dc
                    if nr < 0 or nr >= expanded_height or nc < 0 or nc >= expanded_width:
                        output_grid[r][c] = 9
                        break
                    if output_grid[nr][nc] == 0:
                        output_grid[r][c] = 9
                        break
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common

def p(input_grid):
    color = None
    for r in range(len(input_grid)):
        for c in range(len(input_grid[0])):
            if input_grid[r][c] != 0:
                color = input_grid[r][c]
                break
        if color is not None:
            break
    if color is None:
        return input_grid
    mapped_color = (color % 9) + 1
    height = len(input_grid)
    width = len(input_grid[0])
    expanded_height = height * 2
    expanded_width = width * 2
    output_grid = common.grid(expanded_width, expanded_height, 0)
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                for dr in range(2):
                    for dc in range(2):
                        output_grid[r*2 + dr][c*2 + dc] = mapped_color
    for r in range(expanded_height):
        for c in range(expanded_width):
            if output_grid[r][c] != 0:
                for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                    nr, nc = r + dr, c + dc
                    if nr < 0 or nr >= expanded_height or nc < 0 or nc >= expanded_width:
                        output_grid[r][c] = 9
                        break
                    if output_grid[nr][nc] == 0:
                        output_grid[r][c] = 9
                        break
    return output_grid
