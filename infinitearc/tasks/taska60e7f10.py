# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-09
# ---------------------------------------------------------------

"""
Task ID: a60e7f10
Difficulty: medium

=== Tags ===
- Create grid
- Associate images to patterns
- One yes one no

=== Description ===
The input grids are 2D grids containing a single horizontal or vertical line of
exactly three consecutive cells with the same non-zero color. The output grid
replaces all cells in such lines with color 5, leaving all other cells
unchanged. If no such line exists in the input, the output grid is identical to
the input. The transformation is determined by detecting the presence of exactly
three consecutive identical non-zero cells in a row or column, regardless of
surrounding values.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    grid_in = [[0] * width for _ in range(height)]
    color = random.choice([1,2,3,4,6,7,8,9])
    is_horizontal = random.choice([True, False])
    
    if is_horizontal:
        if width < 3:
            width = 3
            grid_in = [[0] * width for _ in range(height)]
        r = random.randint(0, height-1)
        s = random.randint(0, width-3)
        grid_in[r][s] = color
        grid_in[r][s+1] = color
        grid_in[r][s+2] = color
        if s > 0:
            grid_in[r][s-1] = 0
        if s+3 < width:
            grid_in[r][s+3] = 0
        grid_out = [row[:] for row in grid_in]
        grid_out[r][s] = 5
        grid_out[r][s+1] = 5
        grid_out[r][s+2] = 5
    else:
        if height < 3:
            height = 3
            grid_in = [[0] * width for _ in range(height)]
        c = random.randint(0, width-1)
        r = random.randint(0, height-3)
        grid_in[r][c] = color
        grid_in[r+1][c] = color
        grid_in[r+2][c] = color
        if r > 0:
            grid_in[r-1][c] = 0
        if r+3 < height:
            grid_in[r+3][c] = 0
        grid_out = [row[:] for row in grid_in]
        grid_out[r][c] = 5
        grid_out[r+1][c] = 5
        grid_out[r+2][c] = 5
    
    return {"input": grid_in, "output": grid_out}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    # Convert input to list of lists if it's a tuple
    if isinstance(input_grid, tuple):
        input_grid = [list(row) for row in input_grid]
    height = len(input_grid)
    width = len(input_grid[0]) if height > 0 else 0
    output = [row[:] for row in input_grid]
    
    # Check horizontal lines
    for r in range(height):
        for c in range(width - 2):
            if input_grid[r][c] != 0 and input_grid[r][c] == input_grid[r][c+1] == input_grid[r][c+2]:
                output[r][c] = 5
                output[r][c+1] = 5
                output[r][c+2] = 5
                return output
    
    # Check vertical lines
    for c in range(width):
        for r in range(height - 2):
            if input_grid[r][c] != 0 and input_grid[r][c] == input_grid[r+1][c] == input_grid[r+2][c]:
                output[r][c] = 5
                output[r+1][c] = 5
                output[r+2][c] = 5
                return output
    
    return output
