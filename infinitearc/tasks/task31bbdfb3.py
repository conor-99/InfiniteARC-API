# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 31bbdfb3
Difficulty: medium–hard

=== Tags ===
- Guided flow
- Source target routing

=== Description ===
**Task Description: Guided Flow Routing**    Input grids depict a maze-like
environment on a uniform background. Key elements include:    - **Sources**:
Single red cells positioned along the left edge of the grid, never adjacent to
walls or obstacles.   - **Targets**: Single blue cells positioned along the
right edge of the grid, each corresponding to exactly one source.   - **Guided
Paths**: A network of connected cells forming directional pathways. Each cell’s
color encodes its movement direction:     - **Green** indicates movement to the
right (east),     - **Yellow** indicates movement upward (north),     - **Cyan**
indicates movement to the left (west),     - **Magenta** indicates movement
downward (south).    Guided paths are acyclic, non-overlapping, and form a
single, continuous route from each source to its corresponding target. Paths may
twist, turn, and navigate around background cells but never intersect with other
paths, sources, or targets.    The output grid replaces all cells along the
**source-to-target path** with **orange**, while preserving sources (red),
targets (blue), and the background. Directional indicators (green, yellow, etc.)
are **not visible** in the output, as they are replaced by the orange path. The
transformation is deterministic: the flow follows the directional indicators in
sequence from source to target, with each step moving in the direction specified
by the current cell’s color.    No loops, overlaps, or modifications occur
outside the path. The output reflects only the orange path connecting each
source to its target, with all other grid elements unchanged.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(5, 30)
    height = random.randint(5, 30)
    grid = [[0] * width for _ in range(height)]
    
    # Place sources on left edge (column 0)
    sources = []
    num_sources = random.randint(1, 2)
    for _ in range(num_sources):
        r = random.randint(1, height-2)
        grid[r][0] = 2  # red
        sources.append(r)
    
    # Place targets on right edge (column width-1)
    for r in sources:
        target_r = r
        while target_r == r:
            target_r = random.randint(1, height-2)
        grid[target_r][width-1] = 1  # blue
    
    # Generate paths for each source
    for i in range(num_sources):
        src_r = sources[i]
        # Find target row for this source
        target_r = None
        for r in range(height):
            if grid[r][width-1] == 1:
                target_r = r
                break
        
        # Move right to column width-2
        for c in range(1, width-1):
            grid[src_r][c] = 3  # green
        
        # Move vertically to target row
        if src_r < target_r:
            for r in range(src_r+1, target_r):
                grid[r][width-2] = 6  # magenta (down)
            grid[target_r][width-2] = 3  # green (right to target)
        else:
            for r in range(src_r-1, target_r, -1):
                grid[r][width-2] = 4  # yellow (up)
            grid[target_r][width-2] = 3  # green (right to target)
    
    # Create output grid
    output = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            if grid[r][c] == 2:
                output[r][c] = 2
            elif grid[r][c] == 1:
                output[r][c] = 1
            elif grid[r][c] in [3,4,5,6]:
                output[r][c] = 7
            else:
                output[r][c] = 0
    
    return {
        "input": grid,
        "output": output
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    output = []
    for row in input_grid:
        new_row = []
        for cell in row:
            if cell in [3,4,5,6]:
                new_row.append(7)
            else:
                new_row.append(cell)
        output.append(new_row)
    return output
