# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: 9af8082a
Difficulty: easy

=== Tags ===
- Align to corner
- Recolor smallest component
- Extend stem to border
- Rectangle guessing

=== Description ===
The task involves transforming an input grid into an output grid by following
these steps: First, identify the smallest connected component (ignoring
background value 0), which is the group of adjacent cells (horizontally or
vertically) with the fewest cells. Recolor all cells of this component to a
fixed new color (e.g., color 1). Next, extend this recolored component in the
direction of the nearest grid border (left, right, top, or bottom) until it
reaches the border. Finally, align the entire extended component so that its
top-left cell is positioned at the grid's top-left corner (0,0), maintaining the
extended shape. The smallest component is always small (e.g., 1â€“3 cells), and
the extension direction is determined by the closest border to the component's
position. This ensures the output grid clearly shows the recolored, extended,
and corner-aligned component.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from common import grid
def generate():
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    r = random.randint(1, height - 2)
    c = random.randint(1, width - 2)
    comp_color = random.randint(1, 9)
    input_grid = grid(width, height, 0)
    input_grid[r][c] = comp_color

    dist_top = r
    dist_bottom = height - 1 - r
    dist_left = c
    dist_right = width - 1 - c
    distances = [dist_top, dist_bottom, dist_left, dist_right]
    dir_idx = distances.index(min(distances))

    output_grid = grid(width, height, 0)
    if dir_idx == 0:  # top
        length = r + 1
        for i in range(length):
            output_grid[i][0] = 1
    elif dir_idx == 1:  # bottom
        length = height - r
        for i in range(length):
            output_grid[i][0] = 1
    elif dir_idx == 2:  # left
        length = c + 1
        for i in range(length):
            output_grid[0][i] = 1
    else:  # right
        length = width - c
        for i in range(length):
            output_grid[0][i] = 1

    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common
from common import grid
def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    visited = [[False] * width for _ in range(height)]
    components = []

    for r in range(height):
        for c in range(width):
            if not visited[r][c] and input_grid[r][c] != 0:
                comp = []
                stack = [(r, c)]
                visited[r][c] = True
                while stack:
                    cr, cc = stack.pop()
                    comp.append((cr, cc))
                    for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                        nr, nc = cr + dr, cc + dc
                        if 0 <= nr < height and 0 <= nc < width and not visited[nr][nc] and input_grid[nr][nc] != 0:
                            visited[nr][nc] = True
                            stack.append((nr, nc))
                components.append(comp)

    if not components:
        return grid(width, height, 0)

    smallest = min(components, key=len)
    top = min(r for r, c in smallest)
    bottom = max(r for r, c in smallest)
    left = min(c for r, c in smallest)
    right = max(c for r, c in smallest)

    dist_top = top
    dist_bottom = height - 1 - bottom
    dist_left = left
    dist_right = width - 1 - right
    distances = [dist_top, dist_bottom, dist_left, dist_right]
    dir_idx = distances.index(min(distances))

    output_grid = grid(width, height, 0)
    if dir_idx == 0:  # top
        length = top + 1
        for i in range(length):
            output_grid[i][0] = 1
    elif dir_idx == 1:  # bottom
        length = height - bottom
        for i in range(length):
            output_grid[i][0] = 1
    elif dir_idx == 2:  # left
        length = left + 1
        for i in range(length):
            output_grid[0][i] = 1
    else:  # right
        length = width - right
        for i in range(length):
            output_grid[0][i] = 1

    return output_grid
