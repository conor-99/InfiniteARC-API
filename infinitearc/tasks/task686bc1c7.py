# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: 686bc1c7
Difficulty: medium

=== Tags ===
- Count hor lines
- Detect vertical symmetry
- Take negative
- Fractal repetition

=== Description ===
The task involves transforming an input grid into an output grid through four
sequential visual operations. First, the input grid is vertically symmetric
(left and right halves mirror each other), a property inherent to all provided
inputs. Next, the grid is analyzed to count "horizontal lines," defined as rows
where all cells share the same color; this count is denoted as N. The colors in
the grid are then inverted (each color c becomes 9 - c), a visual transformation
applied uniformly. Finally, the grid undergoes fractal repetition: every cell in
the input is replaced by an N×N block of its inverted color, scaling the grid
dimensions to (input_rows × N) × (input_cols × N). The output grid thus reflects
the visual pattern of scaled, inverted, symmetric input features, where the
repetition factor N is directly derived from the count of uniform horizontal
rows.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    while True:
        R = random.randint(1, 30)
        C = random.randint(1, 30)
        grid = []
        for _ in range(R):
            row = [0] * C
            for c in range((C + 1) // 2):
                row[c] = random.randint(0, 9)
            for c in range((C + 1) // 2, C):
                row[c] = row[C - 1 - c]
            grid.append(row)
        N = sum(1 for row in grid if all(x == row[0] for x in row))
        if N == 0:
            continue
        if R * N > 30 or C * N > 30:
            continue
        inverted_grid = [[9 - cell for cell in row] for row in grid]
        output = []
        for row in inverted_grid:
            for _ in range(N):
                new_row = []
                for cell in row:
                    new_row.extend([cell] * N)
                output.append(new_row)
        if grid == output:
            continue
        return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import random

def p(input_grid):
    N = sum(1 for row in input_grid if all(x == row[0] for x in row))
    inverted = [[9 - cell for cell in row] for row in input_grid]
    output = []
    for row in inverted:
        for _ in range(N):
            new_row = []
            for cell in row:
                new_row.extend([cell] * N)
            output.append(new_row)
    return output
