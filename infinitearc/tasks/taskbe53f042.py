# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: be53f042
Difficulty: medium

=== Tags ===
- Connect the dots
- Even or odd

=== Description ===
The input grid contains scattered dots (represented by color 1) on a background
(color 0). For even-indexed rows (0, 2, 4, ...), horizontally separated dots are
connected by drawing a line (color 2) through the background cells between them.
For odd-indexed rows (1, 3, 5, ...), vertically separated dots are connected by
drawing a line (color 2) through the background cells between them. Dots without
adjacent dots of the same parity remain as isolated dots, and all background
cells (color 0) remain unchanged. The transformation relies on the parity of the
row index to determine connection direction, requiring recognition of structural
patterns rather than numerical values.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    from common import grid
    while True:
        width = random.randint(1, 30)
        height = random.randint(1, 30)
        if width >= 3:
            break
    input_grid = grid(width, height, 0)
    even_rows = [i for i in range(height) if i % 2 == 0]
    if even_rows:
        row = random.choice(even_rows)
        col1 = random.randint(0, width - 1)
        col2 = random.randint(0, width - 1)
        while col2 == col1 or abs(col2 - col1) == 1:
            col2 = random.randint(0, width - 1)
        input_grid[row][col1] = 1
        input_grid[row][col2] = 1
    for _ in range(random.randint(0, 10)):
        r = random.randint(0, height - 1)
        c = random.randint(0, width - 1)
        input_grid[r][c] = 1
    output_grid = [row[:] for row in input_grid]
    for i in range(0, height, 2):
        dots = [j for j in range(width) if input_grid[i][j] == 1]
        dots.sort()
        for k in range(1, len(dots)):
            start = dots[k-1]
            end = dots[k]
            for j in range(start + 1, end):
                if output_grid[i][j] == 0:
                    output_grid[i][j] = 2
    for j in range(width):
        dots = [i for i in range(1, height, 2) if input_grid[i][j] == 1]
        dots.sort()
        for k in range(1, len(dots)):
            start = dots[k-1]
            end = dots[k]
            for i in range(start + 1, end):
                if output_grid[i][j] == 0:
                    output_grid[i][j] = 2
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if isinstance(input_grid, tuple):
        input_grid = [list(row) for row in input_grid]
    height = len(input_grid)
    width = len(input_grid[0])
    output_grid = [row[:] for row in input_grid]
    for i in range(0, height, 2):
        dots = [j for j in range(width) if input_grid[i][j] == 1]
        dots.sort()
        for k in range(1, len(dots)):
            start = dots[k-1]
            end = dots[k]
            for j in range(start + 1, end):
                if output_grid[i][j] == 0:
                    output_grid[i][j] = 2
    for j in range(width):
        dots = [i for i in range(1, height, 2) if input_grid[i][j] == 1]
        dots.sort()
        for k in range(1, len(dots)):
            start = dots[k-1]
            end = dots[k]
            for i in range(start + 1, end):
                if output_grid[i][j] == 0:
                    output_grid[i][j] = 2
    return output_grid
