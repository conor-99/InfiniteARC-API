# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: 60fa9b3b
Difficulty: hard

=== Tags ===
- Obstacles
- Take half
- Pattern reflection
- Gravity

=== Description ===
The task involves transforming an input grid where specific elements (obstacles,
represented by the color value 9) block movement. First, apply right gravity:
all non-obstacle elements (values 0-8) shift to the right within their rows,
stopping at obstacles or the grid edge. Next, take the left half of the
transformed grid (columns 0 to floor(width/2) - 1). Finally, reflect this left
half horizontally (mirror across the vertical axis) to form the output grid.
Input grids feature complex arrangements of obstacles across rows and columns,
requiring the solver to sequentially navigate obstacle constraints, halve the
grid, and apply reflectionâ€”each step dependent on precise interpretation of the
obstacle positions and their impact on element movement. The output grid is a
mirrored version of the left half of the gravity-shifted grid, demanding
recognition of multiple interdependent rules rather than isolated visual cues.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    width = random.randint(2, 30)
    height = random.randint(1, 30)
    grid = [[random.randint(0, 8) for _ in range(width)] for _ in range(height)]
    for i in range(height):
        for j in range(width):
            if random.random() < 0.2:
                grid[i][j] = 9
    gravity_grid = []
    for row in grid:
        non_9 = [x for x in row if x != 9]
        new_row = [9] * (width - len(non_9)) + non_9
        gravity_grid.append(new_row)
    left_half_width = width // 2
    left_half = [row[:left_half_width] for row in gravity_grid]
    output = [row[::-1] for row in left_half]
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    gravity_grid = []
    for row in input_grid:
        non_9 = [x for x in row if x != 9]
        new_row = [9] * (width - len(non_9)) + non_9
        gravity_grid.append(new_row)
    left_half_width = width // 2
    left_half = [row[:left_half_width] for row in gravity_grid]
    output = [row[::-1] for row in left_half]
    return output
