# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: 77068d6a
Difficulty: insane

=== Tags ===
- Take intersection

=== Description ===
The input grid features a central vertical line (color S) that divides the grid
into left and right sections. Each section contains a distinct, complex shape
composed of a single color (Y) against a background of another color (N). The
shapes on both sides are intricate, with multiple disconnected components,
overlapping patterns, and irregular boundaries, making their spatial
relationship challenging to discern. The output grid is generated by identifying
all positions where both the left and right sections contain the shape color (Y)
simultaneously, marking these overlapping regions with a new color (M), while
all other positions retain the background color (N). For "insane" difficulty,
the left and right shapes are designed to have subtle, non-symmetric overlaps
that require careful cross-referencing of both sections to determine the exact
intersection points, with no obvious visual cues beyond the spatial alignment of
Y-colored pixels.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from common import rand_sprite

def generate():
    while True:
        width = random.randint(5, 29) | 1
        height = random.randint(1, 30)
        mid = width // 2
        input_grid = [[0] * width for _ in range(height)]
        for r in range(height):
            input_grid[r][mid] = 5

        left_pixels = rand_sprite('aitch', mid, height)
        for (r, c) in left_pixels:
            input_grid[r][c] = 4

        right_width = width - mid - 1
        if right_width <= 0:
            continue
        right_pixels = rand_sprite('el', right_width, height)
        for (r, c) in right_pixels:
            input_grid[r][mid + 1 + c] = 4

        has_intersection = False
        for r in range(height):
            for c in range(mid):
                mirror_c = 2 * mid - c
                if input_grid[r][c] == 4 and input_grid[r][mirror_c] == 4:
                    has_intersection = True
                    break
            if has_intersection:
                break

        if has_intersection:
            break

    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        output_grid[r][mid] = 5
    for r in range(height):
        for c in range(mid):
            mirror_c = 2 * mid - c
            if input_grid[r][c] == 4 and input_grid[r][mirror_c] == 4:
                output_grid[r][c] = 6
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    mid = width // 2

    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        output_grid[r][mid] = 5

    for r in range(height):
        for c in range(mid):
            mirror_c = 2 * mid - c
            if input_grid[r][c] == 4 and input_grid[r][mirror_c] == 4:
                output_grid[r][c] = 6
    return output_grid
