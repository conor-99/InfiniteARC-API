# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-10
# ---------------------------------------------------------------

"""
Task ID: e36bf433
Difficulty: easy

=== Tags ===
- Portals
- Mark centroid
- Crop
- Take complement

=== Description ===
The input grid contains a shape formed by non-zero values. The output grid is
derived through the following steps: first, compute the centroid (center of
mass) of all non-zero cells by averaging their row and column coordinates. Next,
extract a 3×3 subgrid from the input centered at this centroid (adjusting for
edge cases by using the available area without padding). Finally, apply a
complement operation to this subgrid, where each non-zero value is replaced with
0 and each zero value is replaced with 9. The resulting 3×3 grid is the output.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    while True:
        height = random.randint(5, 30)
        width = random.randint(5, 30)
        color = random.randint(1, 9)
        pixels = []
        for r in range(height):
            for c in range(width):
                if random.random() < 0.3:
                    pixels.append((r, c))
        if not pixels:
            continue
        sum_r = sum(r for r, c in pixels)
        sum_c = sum(c for r, c in pixels)
        centroid_r = round(sum_r / len(pixels))
        centroid_c = round(sum_c / len(pixels))
        if centroid_r < 1 or centroid_r > height - 2 or centroid_c < 1 or centroid_c > width - 2:
            continue
        input_grid = [[0] * width for _ in range(height)]
        for (r, c) in pixels:
            input_grid[r][c] = color
        top = centroid_r - 1
        left = centroid_c - 1
        subgrid = [input_grid[r][left:left+3] for r in range(top, top+3)]
        output_grid = [[0 if cell != 0 else 9 for cell in row] for row in subgrid]
        return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    non_zero = []
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                non_zero.append((r, c))
    if not non_zero:
        return [[9]*3 for _ in range(3)]
    centroid_r = round(sum(r for r, c in non_zero) / len(non_zero))
    centroid_c = round(sum(c for r, c in non_zero) / len(non_zero))
    top = max(0, centroid_r - 1)
    left = max(0, centroid_c - 1)
    subgrid = []
    for i in range(3):
        r = top + i
        if r >= height:
            break
        subgrid.append(input_grid[r][left:left+3])
    output = []
    for row in subgrid:
        output.append([0 if x != 0 else 9 for x in row])
    return output
