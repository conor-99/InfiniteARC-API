# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 84b002f9
Difficulty: medium

=== Tags ===
- Periodic run length encoding

=== Description ===
The task involves transforming each row of the input grid by replacing
consecutive runs of identical colors with a color from a fixed periodic sequence
based on the run's position in the row. For example, if the periodic sequence is
[1, 2, 3], the first run in a row is replaced with color 1, the second run with
color 2, the third run with color 3, the fourth run with color 1, and this
pattern repeats. The output grid maintains the same dimensions as the input
grid, with each cell's color determined by the position of its run within the
row. The periodic sequence length is consistent across all rows and grids, and
the rule is applied independently to each row without considering vertical
relationships. This requires recognizing run-length patterns and applying a
cyclic color mapping based on run order, avoiding reliance on numerical values
or sums.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    period = 3
    seq = [1, 2, 3]
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    
    output_grid = []
    for row in input_grid:
        current = row[0]
        count = 1
        runs = []
        for i in range(1, len(row)):
            if row[i] == current:
                count += 1
            else:
                runs.append((current, count))
                current = row[i]
                count = 1
        runs.append((current, count))
        new_row = []
        for idx, (color, length) in enumerate(runs):
            new_color = seq[idx % period]
            new_row.extend([new_color] * length)
        output_grid.append(new_row)
    
    if input_grid == output_grid:
        for _ in range(10):
            input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
            output_grid = []
            for row in input_grid:
                current = row[0]
                count = 1
                runs = []
                for i in range(1, len(row)):
                    if row[i] == current:
                        count += 1
                    else:
                        runs.append((current, count))
                        current = row[i]
                        count = 1
                runs.append((current, count))
                new_row = []
                for idx, (color, length) in enumerate(runs):
                    new_color = seq[idx % period]
                    new_row.extend([new_color] * length)
                output_grid.append(new_row)
            if input_grid != output_grid:
                break
        else:
            input_grid[0][0] = (input_grid[0][0] + 1) % 10
            output_grid = []
            for row in input_grid:
                current = row[0]
                count = 1
                runs = []
                for i in range(1, len(row)):
                    if row[i] == current:
                        count += 1
                    else:
                        runs.append((current, count))
                        current = row[i]
                        count = 1
                runs.append((current, count))
                new_row = []
                for idx, (color, length) in enumerate(runs):
                    new_color = seq[idx % period]
                    new_row.extend([new_color] * length)
                output_grid.append(new_row)
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    period = 3
    seq = [1, 2, 3]
    output_grid = []
    for row in input_grid:
        current = row[0]
        count = 1
        runs = []
        for i in range(1, len(row)):
            if row[i] == current:
                count += 1
            else:
                runs.append((current, count))
                current = row[i]
                count = 1
        runs.append((current, count))
        new_row = []
        for idx, (color, length) in enumerate(runs):
            new_color = seq[idx % period]
            new_row.extend([new_color] * length)
        output_grid.append(new_row)
    return output_grid
