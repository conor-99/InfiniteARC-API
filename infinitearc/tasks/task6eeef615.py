# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-09
# ---------------------------------------------------------------

"""
Task ID: 6eeef615
Difficulty: medium

=== Tags ===
- Pattern modification
- Recoloring
- Pattern deconstruction
- Recolor object based on neighbor count

=== Description ===
The task involves transforming an input grid where each connected region (group
of orthogonally adjacent cells with the same color) is recolored based on the
number of orthogonally adjacent cells within its own region. For every cell in
the input grid, count how many of its four orthogonal neighbors (up, down, left,
right) belong to the same connected region (i.e., share the same color and are
part of the same contiguous group). The output grid replaces each cell with this
count value (0â€“4, as a cell can have at most four neighbors in a region). For
example, an isolated cell (no neighbors in its region) becomes 0, a cell at the
end of a line (one neighbor) becomes 1, a cell in the middle of a line (two
neighbors) becomes 2, and so on. The structure of the regions remains unchanged,
but their colors are replaced by the neighbor count, creating a visual pattern
where the intensity of color reflects the local connectivity of each cell. This
requires recognizing connected regions and applying a consistent neighbor-based
recoloring rule without relying on absolute color values or numerical sums.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random

def generate():
    width = common.randint(1, 30)
    height = common.randint(1, 30)
    input_grid = common.grid(width, height, 0)
    for r in range(height):
        for c in range(width):
            input_grid[r][c] = common.random_color(exclude=[0,1,2,3,4])
    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            count = 0
            for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                nr = r + dr
                nc = c + dc
                if 0 <= nr < height and 0 <= nc < width:
                    if input_grid[nr][nc] == input_grid[r][c]:
                        count += 1
            output_grid[r][c] = count
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    output_grid = [[0] * width for _ in range(height)]
    for r in range(height):
        for c in range(width):
            count = 0
            for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                nr = r + dr
                nc = c + dc
                if 0 <= nr < height and 0 <= nc < width:
                    if input_grid[nr][nc] == input_grid[r][c]:
                        count += 1
            output_grid[r][c] = count
    return output_grid
