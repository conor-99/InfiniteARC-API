# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-07
# ---------------------------------------------------------------

"""
Task ID: d804aeae
Difficulty: easy

=== Tags ===
- Draw parallel line
- Pattern coloring
- Permute rows by length

=== Description ===
The task involves transforming an input grid through two primary operations.
First, the rows of the input grid are reordered based on the length of their
non-zero element sequences, sorted from longest to shortest. Second, a pattern
coloring is applied to the non-zero elements within each row, alternating
between two distinct colors (e.g., starting with color 1, followed by color 2,
repeating as needed). The output grid maintains the same dimensions as the
input, with rows permuted by non-zero length and non-zero elements recolored
according to the alternating pattern. This creates a visual effect of parallel
horizontal lines formed by the alternating color patterns across rows.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from common import grid

def generate():
    width = random.randint(4, 5)
    height = random.randint(3, width)
    counts = list(range(1, height + 1))
    random.shuffle(counts)
    while counts == list(range(height, 0, -1)):
        random.shuffle(counts)
    
    input_grid = grid(width, height, 0)
    for i in range(height):
        non_zero_positions = random.sample(range(width), counts[i])
        for pos in non_zero_positions:
            input_grid[i][pos] = random.randint(1, 9)
    
    sorted_indices = sorted(range(height), key=lambda i: counts[i], reverse=True)
    output_grid = [input_grid[i] for i in sorted_indices]
    
    for i in range(height):
        color = 1
        for j in range(width):
            if output_grid[i][j] != 0:
                output_grid[i][j] = color
                color = 3 - color
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    height = len(input_grid)
    width = len(input_grid[0])
    
    counts = [sum(1 for x in row if x != 0) for row in input_grid]
    sorted_indices = sorted(range(height), key=lambda i: counts[i], reverse=True)
    sorted_rows = [list(input_grid[i]) for i in sorted_indices]
    
    for i in range(height):
        color = 1
        for j in range(width):
            if sorted_rows[i][j] != 0:
                sorted_rows[i][j] = color
                color = 3 - color
    return sorted_rows
