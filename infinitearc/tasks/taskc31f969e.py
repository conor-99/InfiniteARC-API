# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: c31f969e
Difficulty: hard

=== Tags ===
- Diagonals
- Image rotation
- Associate images to numbers

=== Description ===
The task involves input grids where a contiguous segment of a single color
exists along the main diagonal (top-left to bottom-right). The output grid is
generated by first rotating the input grid 90 degrees clockwise, then replacing
all instances of the segment's color with the length of that contiguous segment.
The solver must identify the main diagonal, locate the longest contiguous color
segment on it, compute its length, apply the rotation, and perform the color
replacement. This requires multi-step reasoning involving diagonal analysis,
segment length calculation, and grid transformation, making it challenging to
discover through simple pattern recognition.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    L = random.randint(1, 9)
    size = random.randint(L, 2*L - 1)
    grid = [[0] * size for _ in range(size)]
    
    C = random.randint(1, 9)
    D = random.randint(0, 9)
    while D == C:
        D = random.randint(0, 9)
    
    start = random.randint(0, size - L)
    
    for i in range(size):
        if start <= i < start + L:
            grid[i][i] = C
        else:
            grid[i][i] = D
    
    for i in range(size):
        for j in range(size):
            if i != j:
                grid[i][j] = random.randint(0, 9)
    
    rotated = [list(row) for row in zip(*grid[::-1])]
    output = [[L if pixel == C else pixel for pixel in row] for row in rotated]
    
    return {
        "input": grid,
        "output": output
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    n = min(len(input_grid), len(input_grid[0]))
    diag = [input_grid[i][i] for i in range(n)]
    
    max_length = 0
    current_length = 0
    current_color = None
    segment_color = None
    
    for color in diag:
        if color == current_color:
            current_length += 1
        else:
            if current_length > max_length:
                max_length = current_length
                segment_color = current_color
            current_color = color
            current_length = 1
    
    if current_length > max_length:
        max_length = current_length
        segment_color = current_color
    
    rotated = [list(row) for row in zip(*input_grid[::-1])]
    output = [[max_length if cell == segment_color else cell for cell in row] for row in rotated]
    
    return output
