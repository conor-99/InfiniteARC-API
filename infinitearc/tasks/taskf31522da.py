# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: f31522da
Difficulty: hard

=== Tags ===
- Inside out

=== Description ===
The task involves transforming input grids into output grids by preserving the
outer border (first and last rows and columns) while reversing the order of the
rows within the inner region. The inner region consists of all cells not on the
outermost perimeter of the grid. For grids with dimensions smaller than 4×4, the
inner region would be insufficient to reverse (e.g., 3×3 grids have a 1×1 inner
region, which remains unchanged), so the generator ensures all input grids are
at least 4×4 in size. The transformation is deterministic: the top row of the
inner region becomes the bottom row, and vice versa, with all other inner rows
shifting accordingly. This requires recognizing the border, isolating the inner
region, and applying a row reversal, making it a challenging task that demands
precise abstraction of spatial relationships rather than simple pattern
matching.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    h = random.randint(4, 30)
    w = random.randint(4, 30)
    input_grid = [[random.randint(0, 9) for _ in range(w)] for _ in range(h)]
    output_grid = [row[:] for row in input_grid]
    inner_rows = input_grid[1:h-1]
    output_grid[1:h-1] = inner_rows[::-1]
    if input_grid == output_grid:
        for _ in range(10):
            input_grid = [[random.randint(0, 9) for _ in range(w)] for _ in range(h)]
            output_grid = [row[:] for row in input_grid]
            inner_rows = input_grid[1:h-1]
            output_grid[1:h-1] = inner_rows[::-1]
            if input_grid != output_grid:
                break
        else:
            input_grid[1][1] = (input_grid[1][1] + 1) % 10
            output_grid = [row[:] for row in input_grid]
            inner_rows = input_grid[1:h-1]
            output_grid[1:h-1] = inner_rows[::-1]
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    h = len(input_grid)
    output = [row[:] for row in input_grid]
    if h >= 4:
        output[1:h-1] = input_grid[1:h-1][::-1]
    return output
