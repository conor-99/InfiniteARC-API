# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 16a321a9
Difficulty: hard

=== Tags ===
- Associate colors to ranks

=== Description ===
The task involves transforming an input grid into an output grid by associating
each color (value 0-9) with a rank based on the order of its first occurrence in
row-major order (top-left to bottom-right). The rank of a color is determined by
the sequence in which it first appears across the grid: the first unique color
encountered is assigned rank 0, the next unique color rank 1, and so on. Each
cell in the output grid is replaced by the rank corresponding to its input
color's rank. This requires identifying the precise order of first appearances
across the grid, making the rule non-trivial to deduce, especially for grids
with multiple scattered colors. The output grid will always differ from the
input grid as long as more than one unique color is present, satisfying the task
constraints.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    grid_input = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    if all(grid_input[r][c] == 0 for r in range(height) for c in range(width)):
        r, c = random.randint(0, height-1), random.randint(0, width-1)
        grid_input[r][c] = random.randint(1, 9)
    rank_map = {}
    rank = 0
    for r in range(height):
        for c in range(width):
            color = grid_input[r][c]
            if color not in rank_map:
                rank_map[color] = rank
                rank += 1
    grid_output = [[rank_map[grid_input[r][c]] for c in range(width)] for r in range(height)]
    return {"input": grid_input, "output": grid_output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if not input_grid or not input_grid[0]:
        return []
    rank_map = {}
    rank = 0
    for r in range(len(input_grid)):
        for c in range(len(input_grid[0])):
            color = input_grid[r][c]
            if color not in rank_map:
                rank_map[color] = rank
                rank += 1
    output_grid = [[rank_map[input_grid[r][c]] for c in range(len(input_grid[0]))] for r in range(len(input_grid))]
    return output_grid
