# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-03
# ---------------------------------------------------------------

"""
Task ID: cd479b6c
Difficulty: hard

=== Tags ===
- Detect grid
- Associate color to bools
- Pocket fill

=== Description ===
The task involves transforming an input grid into an output grid through a
multi-step process. The input grid contains a detectable grid structure formed
by connected lines of a specific color (e.g., color 5), creating enclosed
regions referred to as "pockets." Each pocket is a contiguous area bounded by
these grid lines. The transformation requires two key steps: first, detecting
the grid structure to identify all pockets; second, associating each pocket's
internal color with a boolean value based on a predefined rule (e.g., prime-
numbered colors like 2, 3, 5, 7 map to True, while others map to False). For
each pocket, if its internal color corresponds to True, the pocket is filled
with a designated color (e.g., color 9); otherwise, the pocket remains
unchanged. The challenge lies in correctly identifying the grid structure to
isolate pockets, then applying the color-to-boolean association rule to
determine which pockets require filling, all while ensuring the transformation
adheres to consistent, abstract reasoning rather than pixel-level matching.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
import common

def generate():
    minisize = random.randint(2, 5)
    spacing = random.randint(2, 4)
    size = minisize * spacing + 2
    grid = common.hollywood_squares(minisize, b=0, g=5, spacing=spacing)
    
    pockets = set()
    for r in range(size):
        for c in range(size):
            if grid[r][c] != 5:
                pocket_row = r // (spacing + 1)
                pocket_col = c // (spacing + 1)
                pockets.add((pocket_row, pocket_col))
    
    primes = [2, 3, 7]
    non_primes = [1, 4, 6, 8, 9]
    color_options = primes + non_primes
    color_assignments = {}
    for pocket in pockets:
        if not color_assignments:
            color = random.choice(primes)
        else:
            color = random.choice(color_options)
        color_assignments[pocket] = color
    
    for r in range(size):
        for c in range(size):
            if grid[r][c] != 5:
                pocket_row = r // (spacing + 1)
                pocket_col = c // (spacing + 1)
                grid[r][c] = color_assignments[(pocket_row, pocket_col)]
    
    output = [row[:] for row in grid]
    for r in range(size):
        for c in range(size):
            if grid[r][c] in [2, 3, 7]:
                output[r][c] = 9
    
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    output = []
    for row in input_grid:
        new_row = []
        for cell in row:
            if cell != 5 and cell in (2, 3, 7):
                new_row.append(9)
            else:
                new_row.append(cell)
        output.append(new_row)
    return output
