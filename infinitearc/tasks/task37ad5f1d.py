# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: 37ad5f1d
Difficulty: medium

=== Tags ===
- Hole punch pattern
- Color palette

=== Description ===
The task involves transforming an input grid into an output grid by identifying
and removing isolated "edge-free" pixels. An edge-free pixel is defined as a
non-zero pixel that has no adjacent non-zero pixels in any of the four cardinal
directions (up, down, left, right). The output grid is generated by setting all
such edge-free pixels to 0 (empty), while retaining all other pixels unchanged.
This creates a "hole punch" effect where protruding or disconnected parts of the
shape are eliminated, resulting in a more cohesive structure. The transformation
relies solely on visual adjacency relationships within the grid, avoiding
numerical or color-based value comparisons. Input grids contain at least one
edge-free pixel to ensure the output differs from the input, and the solution
requires recognizing isolated pixels within a contiguous shape to apply the rule
correctly.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random

def generate():
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    grid = common.grid(width, height, 0)
    
    # Ensure main_size fits within grid dimensions
    main_size = min(random.randint(2, 5), height, width)
    start_r = random.randint(0, height - main_size)
    start_c = random.randint(0, width - main_size)
    color = random.randint(1, 9)
    for r in range(start_r, start_r + main_size):
        for c in range(start_c, start_c + main_size):
            grid[r][c] = color
    
    # Ensure at least one edge-free pixel
    edgefree = common.edgefree_pixels(grid)
    if not edgefree:
        added = False
        for r in range(height):
            for c in range(width):
                if grid[r][c] != 0:
                    continue
                neighbors = [(r-1, c), (r+1, c), (r, c-1), (r, c+1)]
                all_zeros = True
                for nr, nc in neighbors:
                    if 0 <= nr < height and 0 <= nc < width and grid[nr][nc] != 0:
                        all_zeros = False
                        break
                if all_zeros:
                    grid[r][c] = random.randint(1, 9)
                    added = True
                    break
            if added:
                break
        if not added:
            r, c = random.randint(0, height-1), random.randint(0, width-1)
            grid[r][c] = random.randint(1, 9)
    
    output = [row[:] for row in grid]
    edgefree = common.edgefree_pixels(grid)
    for (r, c) in edgefree:
        output[r][c] = 0
    
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import common

def p(input_grid):
    output = [list(row) for row in input_grid]
    edgefree = common.edgefree_pixels(input_grid)
    for (r, c) in edgefree:
        output[r][c] = 0
    return output
