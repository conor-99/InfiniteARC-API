# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: f97e1fe9
Difficulty: easy

=== Tags ===
- Recolor smallest component

=== Description ===
The input grid consists of multiple connected regions of different colors, where
each region is formed by adjacent cells (horizontally or vertically) sharing the
same color. The task requires identifying the smallest region (the one with the
fewest cells) and recoloring all its cells to a distinct target color (e.g.,
red), while preserving all other regions and their colors exactly as they appear
in the input. The smallest region is uniquely determined by its size, ensuring a
single solution. The output grid differs from the input only in the recolored
smallest region, with no other changes made to the grid structure or other
regions.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(3, 30)
    height = random.randint(3, 30)
    base_color = random.randint(0, 9)
    cell_color = random.randint(0, 9)
    while cell_color == base_color or cell_color == 2:
        cell_color = random.randint(0, 9)
    
    grid = [[base_color] * width for _ in range(height)]
    r = random.randint(0, height-1)
    c = random.randint(0, width-1)
    grid[r][c] = cell_color
    
    output = [row[:] for row in grid]
    output[r][c] = 2
    return {"input": grid, "output": output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    width = len(input_grid[0])
    height = len(input_grid)
    visited = [[False] * width for _ in range(height)]
    components = []
    
    for r in range(height):
        for c in range(width):
            if not visited[r][c]:
                color = input_grid[r][c]
                component = []
                stack = [(r, c)]
                visited[r][c] = True
                while stack:
                    cr, cc = stack.pop()
                    component.append((cr, cc))
                    for dr, dc in [(1,0), (-1,0), (0,1), (0,-1)]:
                        nr, nc = cr + dr, cc + dc
                        if 0 <= nr < height and 0 <= nc < width and not visited[nr][nc] and input_grid[nr][nc] == color:
                            visited[nr][nc] = True
                            stack.append((nr, nc))
                components.append((color, component))
    
    components.sort(key=lambda x: len(x[1]))
    smallest_color, smallest_coords = components[0][0], components[0][1]
    
    output = [list(row) for row in input_grid]  # Fixed line
    for r, c in smallest_coords:
        output[r][c] = 2
    return output
