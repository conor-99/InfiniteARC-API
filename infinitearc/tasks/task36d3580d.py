# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-09
# ---------------------------------------------------------------

"""
Task ID: 36d3580d
Difficulty: insane

=== Tags ===
- Associate colors to colors

=== Description ===
The task involves transforming an input grid into an output grid by associating
each color in the input with a new color based on its relative frequency within
the grid. The transformation rule is as follows: first, count the frequency of
each color in the input grid. Sort the colors in descending order of frequency,
and in case of ties, sort by ascending color value (e.g., color 1 comes before
color 2 if they have the same frequency). Assign the new color 0 to the most
frequent color, 1 to the next most frequent, and so on. Replace every instance
of each original color in the input grid with its corresponding new color in the
output grid. This rule requires abstract reasoning to identify the frequency-
based mapping, as the output depends on the distribution of colors within the
input, not a fixed substitution pattern. The task is challenging due to the need
to derive the mapping dynamically for each grid, making it non-trivial to
discover from a few examples.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

def generate():
    import random
    def apply_color_mapping(grid):
        freq = [0] * 10
        for row in grid:
            for color in row:
                freq[color] += 1
        colors = [c for c in range(10) if freq[c] > 0]
        colors.sort(key=lambda x: (-freq[x], x))
        mapping = {c: i for i, c in enumerate(colors)}
        return [[mapping[c] for c in row] for row in grid]
    
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    
    if all(pixel == 0 for row in input_grid for pixel in row):
        input_grid[0][0] = 1
    
    output_grid = apply_color_mapping(input_grid)
    
    while input_grid == output_grid:
        width = random.randint(1, 30)
        height = random.randint(1, 30)
        input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
        if all(pixel == 0 for row in input_grid for pixel in row):
            input_grid[0][0] = 1
        output_grid = apply_color_mapping(input_grid)
    
    return {"input": input_grid, "output": output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    freq = [0] * 10
    for row in input_grid:
        for color in row:
            freq[color] += 1
    colors = [c for c in range(10) if freq[c] > 0]
    colors.sort(key=lambda x: (-freq[x], x))
    mapping = {c: i for i, c in enumerate(colors)}
    return [[mapping[c] for c in row] for row in input_grid]
