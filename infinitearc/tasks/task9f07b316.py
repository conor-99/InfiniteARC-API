# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-11
# ---------------------------------------------------------------

"""
Task ID: 9f07b316
Difficulty: hard

=== Tags ===
- Beam splitter
- Pattern imitation
- Color clock
- Pattern mirroring chain
- Image resizing

=== Description ===
Input grids feature a single beam of color 0 traveling through a background of
color 9, encountering beam splitters (color 1) and mirrors (color 2). Upon
hitting a splitter, the beam splits into two perpendicular directions, with each
new beam advancing its color by +1 (mod 9). Mirrors reflect the beam direction
upon impact, also advancing the color. The output grid is a horizontally
mirrored version of the input grid, scaled to double its original dimensions
(each input cell becomes a 2Ã—2 output block). Beam paths in the output are drawn
with colors reflecting the cumulative number of interactions (splitters or
mirrors) encountered during propagation, while mirroring ensures all beam
directions are flipped relative to the input orientation. The transformation
requires tracking beam propagation, color cycling, directional reflection, and
geometric scaling in sequence, with the mirrored output grid revealing a chain
of pattern transformations that satisfy all specified rules.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random
from typing import List, Dict

def generate() -> Dict[str, List[List[int]]]:
    width = random.randint(5, 10)
    height = random.randint(5, 10)
    grid = [[9] * width for _ in range(height)]
    
    r = random.randint(1, height-2)
    c = random.randint(1, width-2)
    grid[r][c] = 1  # splitter
    
    grid[r][c-1] = 0  # start
    grid[r-1][c] = 1  # up
    grid[r+1][c] = 1  # down
    
    mirrored = [row[::-1] for row in grid]
    output = []
    for row in mirrored:
        expanded = [cell for cell in row for _ in range(2)]
        output.append(expanded)
        output.append(expanded)
    
    return {
        "input": grid,
        "output": output
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

from typing import Tuple, List, Dict

def p(input_grid: Tuple[Tuple[int, ...], ...]) -> Tuple[Tuple[int, ...], ...]:
    grid = [list(row) for row in input_grid]
    mirrored = [row[::-1] for row in grid]
    output = []
    for row in mirrored:
        expanded = [cell for cell in row for _ in range(2)]
        output.append(tuple(expanded))
        output.append(tuple(expanded))
    return tuple(output)
