# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-02
# ---------------------------------------------------------------

"""
Task ID: 692f09b2
Difficulty: hard

=== Tags ===
- Topological invariance
- Detect grid
- Detect hor lines

=== Description ===
The input grids contain a grid structure formed by horizontal lines, where each
horizontal line is represented as a full row of identical non-zero color values
(e.g., all cells in a row are color 5). The task requires detecting all such
horizontal lines (rows where every cell has the same non-zero value) and
generating an output grid that preserves these lines while spacing them
uniformly vertically. The vertical spacing between consecutive lines in the
output is determined by the average spacing observed between the detected lines
in the input. This ensures topological invariance, as the output's structure
depends solely on the relative arrangement of the lines rather than their
absolute positions in the input. The width of the output grid matches the input
width, while the height equals the number of detected horizontal lines, with the
lines evenly distributed across the output grid's height.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    W = random.randint(2, 30)
    H = random.randint(3, 30)
    k = random.randint(2, min(5, H-1))
    line_indices = sorted(random.sample(range(H), k))
    input_grid = []
    for i in range(H):
        if i in line_indices:
            color = random.randint(1, 9)
            input_grid.append([color] * W)
        else:
            c1 = random.randint(0, 9)
            c2 = random.randint(0, 9)
            while c2 == c1:
                c2 = random.randint(0, 9)
            input_grid.append([c1] + [c2] * (W - 1))
    output_grid = [[input_grid[i][0]] * W for i in line_indices]
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

import random

def p(input_grid):
    lines = []
    for row in input_grid:
        if all(cell == row[0] for cell in row) and row[0] != 0:
            lines.append(row[0])
    return [[color] * len(input_grid[0]) for color in lines]
