# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-08
# ---------------------------------------------------------------

"""
Task ID: ccea70d9
Difficulty: hard

=== Tags ===
- Tile mutation rule
- Fractal growth
- Directed field
- Modular sequence

=== Description ===
Input grids are 15×15 with a background color (0) and a partially formed fractal
structure composed of connected tiles in colors 1-9. A directed field consists
of tiles in a specific color (e.g., 5) that consistently point in one of four
cardinal directions (e.g., all color-5 tiles face right). The fractal grows in
the direction indicated by this field. Each tile's color follows a modular
sequence: colors 1-3 form a cycle (1→2→3→1), 4-6 form another (4→5→6→4), and 7-9
form a third (7→8→9→7). The output grid shows the fractal after one growth step:
tiles adjacent to the current fractal structure in the growth direction replace
background cells (0) with the next color in their modular sequence, while the
directed field (color-5 tiles) remains unchanged. Growth is blocked by non-
background tiles or grid boundaries, and the modular sequence ensures colors
cycle predictably without memorization. The transformation requires identifying
the directed field, applying sequential mutation rules, and propagating growth
directionally—combining spatial reasoning with cyclic pattern recognition.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import common
import random

def generate():
    width, height = 15, 15
    grid_input = [[0] * width for _ in range(height)]
    
    size = random.randint(10, 20)
    pixels = common.continuous_creature(size, width, height)
    
    for r, c in pixels:
        group = random.choice([1, 2, 3])
        if group == 1:
            color = random.choice([1, 2, 3])
        elif group == 2:
            color = random.choice([4, 6])
        else:
            color = random.choice([7, 8, 9])
        grid_input[r][c] = color
    
    num_directed = random.randint(2, 3)
    for _ in range(num_directed):
        r, c = random.randint(0, height-1), random.randint(0, width-1)
        while grid_input[r][c] != 0:
            r, c = random.randint(0, height-1), random.randint(0, width-1)
        grid_input[r][c] = 5
    
    grid_output = [row[:] for row in grid_input]
    for r, c in pixels:
        if c + 1 < width and grid_input[r][c+1] == 0:
            current_color = grid_input[r][c]
            if current_color == 1:
                next_color_val = 2
            elif current_color == 2:
                next_color_val = 3
            elif current_color == 3:
                next_color_val = 1
            elif current_color == 4:
                next_color_val = 5
            elif current_color == 6:
                next_color_val = 4
            elif current_color == 7:
                next_color_val = 8
            elif current_color == 8:
                next_color_val = 9
            elif current_color == 9:
                next_color_val = 7
            grid_output[r][c+1] = next_color_val
    
    return {"input": grid_input, "output": grid_output}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    width = len(input_grid[0])
    height = len(input_grid)
    output_grid = [list(row) for row in input_grid]
    
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] == 0 or input_grid[r][c] == 5:
                continue
            if c + 1 < width and input_grid[r][c+1] == 0:
                current_color = input_grid[r][c]
                if current_color == 1:
                    next_color_val = 2
                elif current_color == 2:
                    next_color_val = 3
                elif current_color == 3:
                    next_color_val = 1
                elif current_color == 4:
                    next_color_val = 5
                elif current_color == 6:
                    next_color_val = 4
                elif current_color == 7:
                    next_color_val = 8
                elif current_color == 8:
                    next_color_val = 9
                elif current_color == 9:
                    next_color_val = 7
                output_grid[r][c+1] = next_color_val
    return output_grid
