# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-06
# ---------------------------------------------------------------

"""
Task ID: 53f3f321
Difficulty: easy

=== Tags ===
- Associate images to patterns
- Fractal repetition
- Mark extrema corners
- Extend stem to border

=== Description ===
The input grid features a single straight-line stem composed of contiguous
pixels of a uniform non-zero color, beginning at one of the grid's four corners
and extending inward. The output grid must extend this stem to reach the
opposite border of the grid (e.g., a top-left starting stem is extended
horizontally to the top-right border), while marking all four grid corners with
a distinct color (e.g., color 5). The transformation follows the principle of
extending the stem's direction to the edge (fractal repetition of the line's
pattern), and the corner markers are consistently placed at the grid's extreme
positions. The task requires no complex reasoning, as the stem is always aligned
with the grid edges, and the corner marking uses a fixed color.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    direction = random.randint(0, 1)
    width = random.randint(4, 30) if direction == 0 else random.randint(2, 30)
    height = random.randint(4, 30) if direction == 1 else random.randint(2, 30)
    corner = random.randint(0, 3)
    
    if corner == 0:  # top-left
        start_r, start_c = 0, 0
        if direction == 0:  # horizontal (right)
            step_r, step_c = 0, 1
            max_len = width
        else:  # vertical (down)
            step_r, step_c = 1, 0
            max_len = height
    elif corner == 1:  # top-right
        start_r, start_c = 0, width - 1
        if direction == 0:  # horizontal (left)
            step_r, step_c = 0, -1
            max_len = width
        else:  # vertical (down)
            step_r, step_c = 1, 0
            max_len = height
    elif corner == 2:  # bottom-left
        start_r, start_c = height - 1, 0
        if direction == 0:  # horizontal (right)
            step_r, step_c = 0, 1
            max_len = width
        else:  # vertical (up)
            step_r, step_c = -1, 0
            max_len = height
    else:  # bottom-right
        start_r, start_c = height - 1, width - 1
        if direction == 0:  # horizontal (left)
            step_r, step_c = 0, -1
            max_len = width
        else:  # vertical (up)
            step_r, step_c = -1, 0
            max_len = height
    
    input_length = random.randint(2, max_len - 2)
    stem_color = random.choice([i for i in range(1, 10) if i != 5])
    
    input_grid = [[0] * width for _ in range(height)]
    r, c = start_r, start_c
    for _ in range(input_length):
        input_grid[r][c] = stem_color
        r += step_r
        c += step_c
    
    output_grid = [[0] * width for _ in range(height)]
    output_grid[0][0] = 5
    output_grid[0][width-1] = 5
    output_grid[height-1][0] = 5
    output_grid[height-1][width-1] = 5
    
    if direction == 0:  # horizontal
        row = 0 if start_r == 0 else height - 1
        for c in range(width):
            if (row == 0 and c in (0, width-1)) or (row == height-1 and c in (0, width-1)):
                continue
            output_grid[row][c] = stem_color
    else:  # vertical
        col = 0 if start_c == 0 else width - 1
        for r in range(height):
            if (r in (0, height-1) and col == 0) or (r in (0, height-1) and col == width-1):
                continue
            output_grid[r][col] = stem_color
    
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    width = len(input_grid[0])
    height = len(input_grid)
    
    corners = [(0, 0), (0, width-1), (height-1, 0), (height-1, width-1)]
    stem_color = None
    start_r, start_c = 0, 0
    
    for r, c in corners:
        if input_grid[r][c] != 0:
            stem_color = input_grid[r][c]
            start_r, start_c = r, c
            break
    
    if stem_color is None:
        stem_color = 1
    
    if start_r == 0 and start_c == 0:  # top-left
        if input_grid[0][1] == stem_color:
            direction = 0  # horizontal
        else:
            direction = 1  # vertical
    elif start_r == 0 and start_c == width-1:  # top-right
        if input_grid[0][width-2] == stem_color:
            direction = 0  # horizontal
        else:
            direction = 1  # vertical
    elif start_r == height-1 and start_c == 0:  # bottom-left
        if input_grid[height-1][1] == stem_color:
            direction = 0  # horizontal
        else:
            direction = 1  # vertical
    else:  # bottom-right
        if input_grid[height-1][width-2] == stem_color:
            direction = 0  # horizontal
        else:
            direction = 1  # vertical
    
    output_grid = [[0] * width for _ in range(height)]
    output_grid[0][0] = 5
    output_grid[0][width-1] = 5
    output_grid[height-1][0] = 5
    output_grid[height-1][width-1] = 5
    
    if direction == 0:  # horizontal
        row = 0 if start_r == 0 else height-1
        for c in range(width):
            if (row == 0 and c in (0, width-1)) or (row == height-1 and c in (0, width-1)):
                continue
            output_grid[row][c] = stem_color
    else:  # vertical
        col = 0 if start_c == 0 else width-1
        for r in range(height):
            if (r in (0, height-1) and col == 0) or (r in (0, height-1) and col == width-1):
                continue
            output_grid[r][col] = stem_color
    
    return output_grid
