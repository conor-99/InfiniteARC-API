# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-09
# ---------------------------------------------------------------

"""
Task ID: fdba2e25
Difficulty: hard

=== Tags ===
- Associate colors to ranks

=== Description ===
The input grids are 2D grids of colors (0-9) containing multiple distinct colors
arranged in complex patterns with varying shapes and connectivity. Each color
corresponds to a unique rank, where the rank order is not directly visible from
the color values but must be inferred from the transformation pattern. The
output grid is generated by sorting all cells in row-major order according to
the rank of their color, with cells of lower ranks appearing before higher
ranks. The rank mapping requires identifying consistent visual patterns across
multiple input-output pairs, as the transformation involves rearranging the
grid's cell order based on an undetermined color-rank association rather than
numeric or positional properties. The complexity arises from the need to deduce
the rank order from the visual distribution of colors in the examples, with
input grids featuring numerous distinct colors and non-trivial spatial
arrangements.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

PERM = [7, 3, 9, 5, 2, 8, 0, 4, 1, 6]

def generate():
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    input_grid = [[random.randint(0, 9) for _ in range(width)] for _ in range(height)]
    
    cells = []
    for r in range(height):
        for c in range(width):
            cells.append((input_grid[r][c], r, c))
    
    cells.sort(key=lambda x: PERM.index(x[0]))
    
    output_grid = [[0] * width for _ in range(height)]
    for idx, (color, r, c) in enumerate(cells):
        output_grid[idx // width][idx % width] = color
    
    if input_grid == output_grid:
        return generate()
    return {
        "input": input_grid,
        "output": output_grid
    }


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

PERM = [7, 3, 9, 5, 2, 8, 0, 4, 1, 6]

def p(input_grid):
    width = len(input_grid[0])
    height = len(input_grid)
    cells = []
    for r in range(height):
        for c in range(width):
            cells.append((input_grid[r][c], r, c))
    
    cells.sort(key=lambda x: PERM.index(x[0]))
    
    output_grid = [[0] * width for _ in range(height)]
    for idx, (color, r, c) in enumerate(cells):
        output_grid[idx // width][idx % width] = color
    return output_grid
