# ---------------------------------------------------------------
# This file was automatically generated. DO NOT EDIT MANUALLY.
# 
# Generated by: conor-99/InfiniteARC/prepare.py
# Date: 2025-11-04
# ---------------------------------------------------------------

"""
Task ID: df171937
Difficulty: easy

=== Tags ===
- Detect symmetry
- Draw rectangle
- Draw line from point
- Image within image

=== Description ===
The input grid contains a symmetrical shape (e.g., vertically or horizontally
mirrored) composed of non-zero pixels. The output grid is generated by first
identifying the minimal bounding box that fully encloses all non-zero pixels in
the input, then drawing a rectangle (using color 5) around this bounding box.
Next, a vertical line (using color 6) is drawn from the center of the bounding
box rectangle to its top edge. The original symmetrical shape remains intact
within the rectangle, forming an "image within image" effect. The symmetry
detection ensures the bounding box aligns with the symmetrical axis, and the
line from the center point (the "point" in "draw line from point") completes the
transformation.
"""


# ---------------------------------------------------------------
# Generator Code
# ---------------------------------------------------------------

import random

def generate():
    width = random.randint(1, 30)
    height = random.randint(1, 30)
    symmetry = random.choice(['vertical', 'horizontal'])
    input_grid = [[0]*width for _ in range(height)]
    
    if symmetry == 'vertical':
        for r in range(height):
            for c in range(width // 2 + 1):
                if random.random() > 0.5:
                    input_grid[r][c] = 1
                    if c != width - 1 - c:
                        input_grid[r][width - 1 - c] = 1
    else:
        for c in range(width):
            for r in range(height // 2 + 1):
                if random.random() > 0.5:
                    input_grid[r][c] = 1
                    if r != height - 1 - r:
                        input_grid[height - 1 - r][c] = 1
    
    if all(all(x == 0 for x in row) for row in input_grid):
        input_grid[0][0] = 1
    
    non_zero = [(r, c) for r in range(height) for c in range(width) if input_grid[r][c] != 0]
    if not non_zero:
        return {'input': input_grid, 'output': input_grid}
    
    min_row = min(r for r, c in non_zero)
    max_row = max(r for r, c in non_zero)
    min_col = min(c for r, c in non_zero)
    max_col = max(c for r, c in non_zero)
    
    output_grid = [row[:] for row in input_grid]
    
    for c in range(min_col, max_col + 1):
        output_grid[min_row][c] = 5
        output_grid[max_row][c] = 5
    for r in range(min_row, max_row + 1):
        output_grid[r][min_col] = 5
        output_grid[r][max_col] = 5
    
    center_row = (min_row + max_row) // 2
    center_col = (min_col + max_col) // 2
    
    for r in range(min_row, center_row + 1):
        output_grid[r][center_col] = 6
    
    if input_grid == output_grid:
        return generate()
    
    return {'input': input_grid, 'output': output_grid}


# ---------------------------------------------------------------
# Solver Code
# ---------------------------------------------------------------

def p(input_grid):
    if not input_grid:
        return input_grid
    height = len(input_grid)
    width = len(input_grid[0])
    
    # Convert input to list of lists if it's a tuple
    input_grid = [list(row) for row in input_grid]
    
    non_zero = []
    for r in range(height):
        for c in range(width):
            if input_grid[r][c] != 0:
                non_zero.append((r, c))
    
    if not non_zero:
        return input_grid
    
    min_row = min(r for r, c in non_zero)
    max_row = max(r for r, c in non_zero)
    min_col = min(c for r, c in non_zero)
    max_col = max(c for r, c in non_zero)
    
    output_grid = [list(row) for row in input_grid]
    
    for c in range(min_col, max_col + 1):
        output_grid[min_row][c] = 5
        output_grid[max_row][c] = 5
    for r in range(min_row, max_row + 1):
        output_grid[r][min_col] = 5
        output_grid[r][max_col] = 5
    
    center_row = (min_row + max_row) // 2
    center_col = (min_col + max_col) // 2
    
    for r in range(min_row, center_row + 1):
        output_grid[r][center_col] = 6
    
    return output_grid
